---
title: Проверка пакетов поставщика вычислительной техники (OEM) с помощью проверки как услуги Azure Stack | Документация Майкрософт
description: Узнайте, как проверить пакеты поставщика вычислительной техники (OEM) с помощью проверки как услуги.
services: azure-stack
documentationcenter: ''
author: mattbriggs
manager: femila
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: tutorial
ms.date: 07/23/2019
ms.author: mabrigg
ms.reviewer: johnhas
ms.lastreviewed: 03/11/2019
ROBOTS: NOINDEX
ms.openlocfilehash: 69bb9c89793789280debe13a142f4c96470f7c31
ms.sourcegitcommit: b95983e6e954e772ca5267304cfe6a0dab1cfcab
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2019
ms.locfileid: "68418318"
---
# <a name="validate-oem-packages"></a>Проверка пакетов OEM

[!INCLUDE [Azure_Stack_Partner](./includes/azure-stack-partner-appliesto.md)]

Вы можете протестировать новый пакет OEM при изменение встроенного ПО или драйверов для проверки завершенного решения. Пакет подписывается корпорацией Майкрософт после прохождения теста. В проверке должен содержаться обновленный пакет расширений OEM с драйверами и встроенным ПО, которые прошли проверки по логотипу и PCS Windows Server.

[!INCLUDE [azure-stack-vaas-workflow-validation-completion](includes/azure-stack-vaas-workflow-validation-completion.md)]

> [!IMPORTANT]
> Перед передачей или отправкой пакетов ознакомьтесь со статьей [Create an OEM package](azure-stack-vaas-create-oem-package.md) (Создание пакета OEM), чтобы получить сведения о предполагаемом формате и содержимом пакета.

## <a name="managing-packages-for-validation"></a>Управление пакетами для проверки

При использовании рабочего процесса **проверки пакета**, чтобы проверить пакет, необходимо будет указать URL-адрес **Azure Storage Blob**. Этот большой двоичный объект является подписанным тестовым пакетом OEM, который будет установлен в рамках процесса обновления. Для создания большого двоичного объекта с помощью учетной записи хранения Azure, созданной во время установки, обратитесь к статье [Руководство по настройке ресурсов для проверки как услуги](azure-stack-vaas-set-up-resources.md).

### <a name="prerequisite-provision-a-storage-container"></a>Предварительные требования: подготовка контейнера хранилища

Создайте контейнер в учетной записи хранения для больших двоичных объектов пакета. Этот контейнер может использоваться для всех ваших запусков проверки пакета.

1. На [портале Azure](https://portal.azure.com) перейдите к учетной записи хранения, созданной в рамках [руководства по настройке ресурсов для проверки как услуги](azure-stack-vaas-set-up-resources.md).

2. В левой колонке в разделе **Служба BLOB-объектов** выберите **Контейнеры**.

3. Щелкните **+ Контейнер** в строке меню.
    1. Укажите имя для контейнера, например `vaaspackages`.
    1. Выберите желаемый уровень доступа для непроверенных клиентов, таких как VaaS (проверка как услуга). Подробнее о том, как предоставить VaaS доступ к пакетам в каждом сценарии, см. в статье об [управлении уровнем доступа к контейнерам](#handling-container-access-level).

### <a name="upload-package-to-storage-account"></a>Отправка пакета в учетную запись хранения

1. Подготовьте пакет, который требуется проверить. Это файл `.zip`, содержимое которого должно соответствовать структуре, описанной в статье о [создании OEM-пакета](azure-stack-vaas-create-oem-package.md).

    > [!NOTE]
    > Убедитесь, что содержимое `.zip` помещается в корне файла `.zip`. В пакете не должно быть вложенных папок.

1. На [портале Azure](https://portal.azure.com) выберите контейнер пакета и отправьте его, выбрав в строке меню **Отправить**.

1. Выберите файл `.zip` пакета для отправки. Оставьте значения по умолчанию для **типа большого двоичного объекта** (т. е. **блочный BLOB-объект**) и **размера блока**.

### <a name="generate-package-blob-url-for-vaas"></a>Создание URL-адреса большого двоичного объекта пакета для VaaS

При создании рабочего процесса **проверки пакета** на портале VaaS необходимо будет указать URL-адрес Azure Storage Blob, содержащего пакет. Некоторые *интерактивные* тесты, включая **ежемесячную проверку обновлений AzureStack** и **проверку пакетов расширения OEM**, также требуют наличия URL-адреса для больших двоичных объектов пакета.

#### <a name="handling-container-access-level"></a>Управление уровнем доступа к контейнеру

Минимальный уровень доступа, требуемый VaaS, зависит от того, что вы делаете: создаете рабочий процесс проверки пакета или планируете *интерактивный* тест.

В случае уровней доступа **Частный** и **BLOB-объект** необходимо временно предоставить доступ к большому двоичному объекту пакета, предоставив VaaS [подписанный URL-адрес](https://docs.microsoft.com/azure/storage/common/storage-dotnet-shared-access-signature-part-1?) (SAS). Уровень доступа **Контейнер** не требует создания URL-адресов SAS, но допускает доступ без проверки подлинности к контейнеру и его большим двоичным объектам.

|Уровень доступа | Требование к рабочему процессу | Требование к тесту |
|---|---------|---------|
|Private | Создайте URL-адрес SAS для каждого большого двоичного объекта пакета ([вариант 1](#option-1-generate-a-blob-sas-url)). | Создайте URL-адрес SAS на уровне учетной записи и вручную добавьте имя большого двоичного объекта пакета ([вариант 2](#option-2-construct-a-container-sas-url)). |
|BLOB-объект | Укажите свойство URL-адреса большого двоичного объекта ([вариант 3](#option-3-grant-public-read-access)). | Создайте URL-адрес SAS на уровне учетной записи и вручную добавьте имя большого двоичного объекта пакета ([вариант 2](#option-2-construct-a-container-sas-url)). |
|Контейнер | Укажите свойство URL-адреса большого двоичного объекта ([вариант 3](#option-3-grant-public-read-access)). | Укажите свойство URL-адреса большого двоичного объекта ([вариант 3](#option-3-grant-public-read-access)).

Варианты предоставления доступа к пакетам упорядочены от доступа с наименьшими правами до доступа с наибольшими правами.

#### <a name="option-1-generate-a-blob-sas-url"></a>Вариант 1. Создание URL-адреса SAS большого двоичного объекта

Используйте этот вариант, если для уровня доступа контейнера хранилища задано значение **Частный**, где контейнер не разрешает общий доступ для чтения к контейнеру или его большим двоичным объектам.

> [!NOTE]
> Этот метод не будет работать с *интерактивными* тестами. См. сведения в разделе [Вариант 2. Создание URL-адреса SAS контейнера](#option-2-construct-a-container-sas-url).

1. Перейдите в свою учетную запись хранения на [портале Azure](https://portal.azure.com/) и откройте ZIP-архив с вашим пакетом.

2. В контекстном меню выберите **Создать SAS**.

3. Выберите **Чтение** в списке **разрешений**.

4. Задайте текущее время в поле **Start time** (Время начала), а в поле **End time** (Время окончания) — время, отстоящее минимум на 48 часов от значения **Start time** (Время начала). Если вы будете создавать другие рабочие процессы с использованием этого пакета, можно увеличить **время окончания** для выполнения тестирования.

5. Щелкните **Создать токен SAS BLOB-объекта и URL-адрес**.

Используйте **URL-адрес SAS BLOB-объекта** при предоставлении URL-адресов больших двоичных объектов пакета.

#### <a name="option-2-construct-a-container-sas-url"></a>Вариант 2. Создание URL-адреса SAS контейнера

Используйте этот вариант, если для уровня доступа контейнера хранилища задано значение **Частный** и вам необходимо предоставить URL-адрес большого двоичного объекта пакета для *интерактивного* теста. Этот URL-адрес также может использоваться на уровне рабочего процесса.

1. [!INCLUDE [azure-stack-vaas-sas-step_navigate](includes/azure-stack-vaas-sas-step_navigate.md)]

1. Выберите **Большой двоичный объект** в разделе **Разрешенные службы**. Снимите все остальные флажки.

1. В разделе **Разрешенные типы ресурсов** выберите **Контейнер** и **Объект**.

1. Выберите **Read** (Чтение) и **List** (Список) в разделе **Предоставленные разрешения**. Снимите все остальные флажки.

1. Задайте текущее время в поле **Время начала**, а в поле **Время окончания** — время, отстоящее минимум на 14 дней от значения **Время начала**. Если вы будете запускать другие тесты с помощью этого пакета, можно увеличить **время окончания** для выполнения тестирования. Все тесты, подготовленные к выполнению с помощью VaaS после истечения **времени окончания**, будут отклонены, и вам нужно будет повторно создать SAS.

1. [!INCLUDE [azure-stack-vaas-sas-step_generate](includes/azure-stack-vaas-sas-step_generate.md)]
    Формат должен выглядеть следующим образом: `https://storageaccountname.blob.core.windows.net/?sv=2016-05-31&ss=b&srt=co&sp=rl&se=2017-05-11T21:41:05Z&st=2017-05-11T13:41:05Z&spr=https`

1. Измените созданный URL-адрес SAS для включения контейнера пакета, `{containername}`, и имя большого двоичного объекта пакета, `{mypackage.zip}`, как показано ниже: `https://storageaccountname.blob.core.windows.net/{containername}/{mypackage.zip}?sv=2016-05-31&ss=b&srt=co&sp=rl&se=2017-05-11T21:41:05Z&st=2017-05-11T13:41:05Z&spr=https`

    Используйте эти значения при предоставлении URL-адресов больших двоичных объектов пакета.

#### <a name="option-3-grant-public-read-access"></a>Вариант 3. Предоставление общего доступа на чтение

Используйте этот вариант, если допустимо разрешить не прошедшим проверку клиентам доступ к отдельным большим двоичным объектам или, в случае *интерактивных* тестов, к контейнеру.

> [!CAUTION]
> Благодаря этому параметру большой двоичный объект открывается для анонимного доступа только для чтения.

1. Установите для уровня доступа к контейнеру пакета значение **BLOB-объект** или **Контейнер**, следуя инструкциям в разделе [Предоставление анонимным пользователям разрешений для контейнеров и больших двоичных объектов](https://docs.microsoft.com/azure/storage/storage-manage-access-to-resources#grant-anonymous-users-permissions-to-containers-and-blobs).

    > [!NOTE]
    > Если вы предоставляете URL-адрес пакета для *интерактивного* теста, необходимо предоставить **полный общий доступ на чтение** к контейнеру, чтобы продолжить тестирование.

1. Чтобы открыть панель свойств, в контейнере пакета выберите большой двоичный объект пакета.

1. Скопируйте **URL-адрес**. Используйте эти значения при предоставлении URL-адресов больших двоичных объектов пакета.

## <a name="create-a-package-validation-workflow"></a>Создание рабочего процесса проверки пакета

1. Войдите на [портал VaaS](https://azurestackvalidation.com).

2. [!INCLUDE [azure-stack-vaas-workflow-step_select-solution](includes/azure-stack-vaas-workflow-step_select-solution.md)]

3. Выберите **Start** (Начать) на плитке **Package Validation** (Проверка пакета).

    ![Плитка рабочего процесса проверки пакета](media/tile_validation-package.png)

4. [!INCLUDE [azure-stack-vaas-workflow-step_naming](includes/azure-stack-vaas-workflow-step_naming.md)]

5. Чтобы ввести URL-адрес большого двоичного объекта службы хранилища Azure в тестовый подписанный пакет OEM, требуется подпись корпорации Майкрософт. Инструкции см. в разделе [Создание URL-адреса большого двоичного объекта пакета для VaaS](#generate-package-blob-url-for-vaas).

6. [!INCLUDE [azure-stack-vaas-workflow-step_upload-stampinfo](includes/azure-stack-vaas-workflow-step_upload-stampinfo.md)]

7. [!INCLUDE [azure-stack-vaas-workflow-step_test-params](includes/azure-stack-vaas-workflow-step_test-params.md)]

    > [!NOTE]
    > Параметры среды невозможно изменить после создания рабочего процесса.

8. [!INCLUDE [azure-stack-vaas-workflow-step_tags](includes/azure-stack-vaas-workflow-step_tags.md)]

9. [!INCLUDE [azure-stack-vaas-workflow-step_submit](includes/azure-stack-vaas-workflow-step_submit.md)]
    Вы будете перенаправлены на страницу сводок по тестам.

## <a name="required-tests"></a>Обязательные тесты

Для проверки пакетов OEM необходимо выполнить следующие тесты:

- OEM Extension Package Verification (Проверка пакетов для расширения OEM);
- Cloud Simulation Engine (Механизм имитации в облаке).

## <a name="run-package-validation-tests"></a>Запуск тестов проверки пакета

1. На странице **Package Validation tests summary** (Сводки по проверочным тестам пакета) будет запущено подмножество тестов, включенных в список, которые соответствуют сценарию.

    В рабочих процессах проверки при **планировании** теста используются общие параметры уровня рабочего процесса, которые вы указали во время его создания (см. раздел [Workflow common parameters for Azure Stack Validation as a Service](azure-stack-vaas-parameters.md) (Общие параметры рабочих процессов для проверки как услуги в Azure Stack)). Если какие-либо из значений параметров станут недействительными, необходимо указать их повторно, как описано в разделе об [изменении параметров рабочего процесса](azure-stack-vaas-monitor-test.md#change-workflow-parameters).

    > [!NOTE]
    > При планировании проверочного теста через существующий экземпляр на портале будет создан новый экземпляр вместо старого. Журналы для старого экземпляра будут сохранены, но недоступны на портале.  
    > После успешного завершения теста действие **Расписание** становится недоступным.

2. Выберите агент, с помощью которого будет выполняться тест. Дополнительные сведения о добавлении локальных агентов для тестирования см. в статье [Развертывание локального агента](azure-stack-vaas-local-agent.md).

3. Чтобы завершить проверку пакетов расширения OEM, в контекстном меню выберите **Расписание**, что позволит открыть командную строку для планирования выполнения тестового экземпляра.

4. Проверьте параметры теста, а затем выберите **Отправить**, чтобы запланировать выполнение проверки пакетов для расширения OEM.

    Проверка пакетов расширения OEM разделена на два выполняемых вручную этапа: обновление Azure Stack и обновление OEM.

   1. **Щелкните** "Выполнить" в пользовательском интерфейсе, чтобы выполнить скрипт предварительной проверки. Это автоматический тест, который занимает около 5 минут и не требует никаких действий.

   1. После завершения действий скрипта предварительной проверки выполните шаг вручную: **установите** последнее доступное обновление Azure Stack, используя портал Azure Stack.

   1. **Запустите** Test-AzureStack в метке. Если возникнут какие-либо ошибки, не продолжайте тестирование и обратитесь по адресу [vaashelp@microsoft.com](mailto:vaashelp@microsoft.com).

       Сведения о том, как запустить команду Test-AzureStack, см. в статье о [проверке состояния системы Azure Stack](../operator/azure-stack-diagnostic-test.md).

   1. **Щелкните** "Далее", чтобы выполнить скрипт последующей проверки. Это автоматический тест, отмечающий окончание процесса обновления Azure Stack.

   1. **Щелкните** "Выполнить", чтобы выполнить скрипт предварительной проверки обновления OEM.

   1. После завершения предварительной проверки выполните шаг вручную: **установите** пакет расширения OEM с помощью портала.

   1. **Запустите** Test-AzureStack в метке.

      > [!NOTE]
      > Если возникнут какие-либо ошибки, не продолжайте тестирование и обратитесь по адресу [vaashelp@microsoft.com](mailto:vaashelp@microsoft.com). Этот шаг очень важен, так как он предотвращает повторное развертывание.

   1. **Щелкните** "Далее", чтобы выполнить скрипт последующей проверки. Это отмечает окончание шага обновления OEM.

   1. Ответьте на все оставшиеся вопросы в конце теста и **щелкните** "Отправить".

   1. Это обозначает конец интерактивного теста.

5. Просмотр результатов проверки пакетов для расширения OEM. После успешного выполнения теста внесите в расписание выполнение механизма имитации в облаке.

Чтобы отправить запрос на подпись пакета, отправьте имя решения и имя проверки пакета, связанные с этим выполнением, по адресу [vaashelp@microsoft.com](mailto:vaashelp@microsoft.com).

## <a name="next-steps"></a>Дополнительная информация

- [Мониторинг теста с помощью проверки как услуги Azure Stack](azure-stack-vaas-monitor-test.md)
