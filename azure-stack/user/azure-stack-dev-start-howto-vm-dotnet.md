---
title: Развертывание веб-приложения C# ASP.NET на виртуальной машине в Azure Stack | Документация Майкрософт
description: Развертывание веб-приложения C# ASP.NET на виртуальной машине в Azure Stack.
services: azure-stack
author: mattbriggs
ms.service: azure-stack
ms.topic: overview
ms.date: 04/24/2019
ms.author: mabrigg
ms.reviewer: sijuman
ms.lastreviewed: 04/24/2019
ms.openlocfilehash: 3f925d7c6a7f08257dbcb054044403e1488d38cb
ms.sourcegitcommit: 41927cb812e6a705d8e414c5f605654da1fc6952
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/25/2019
ms.locfileid: "64482400"
---
# <a name="how-to-deploy-a-c-aspnet-web-app-to-a-vm-in-azure-stack"></a>Развертывание веб-приложения C# ASP.NET на виртуальной машине в Azure Stack

Вы можете создать виртуальную машину для размещения веб-приложения C# (ASP.NET) в Azure Stack. В этой статье рассматриваются шаги, которые нужно выполнить при настройке сервера, конфигурировании сервера для размещения вашего веб-приложения C# (ASP.NET) и последующем развертывании приложения непосредственно из Visual Studio.

C# является языком программирования общего назначения с множеством парадигм, охватывающим строгую типизацию, лексически ограниченные, императивные, декларативные, функциональные, универсальные, объектно-ориентированные и компонентно-ориентированные дисциплины программирования. Дополнительные сведения о языке программирования C# и дополнительные ресурсы см. в [руководстве по C#](https://docs.microsoft.com/dotnet/csharp/).

В этой статье будет использоваться приложение C# 6.0 с помощью ASP.NET Core 2.2, запущенном на сервере Windows 2016.

## <a name="create-a-vm"></a>Создание виртуальной машины

1. Создайте [виртуальную машину Windows Server](azure-stack-quick-windows-portal.md).

2. Запустите следующий сценарий, чтобы установить компоненты на виртуальную машину. Сценарий:
      - Установите IIS (с помощью консоли управления).
      - Установите ASP.NET 4.6.

        ```PowerShell  
        # Install IIS (with Management Console)
        Install-WindowsFeature -name Web-Server -IncludeManagementTools
        
        # Install ASP.NET 4.6
        Install-WindowsFeature Web-Asp-Net45
        
        # Install Web Management Service
        Install-WindowsFeature -Name Web-Mgmt-Service
        ```

3. Скачайте [MSI для веб-развертывания 3.6](https://www.microsoft.com/download/details.aspx?id=43717). Установите из MSI, а затем включите все компоненты.

4. Установите на сервер пакет размещения .NET Core для версии 2.2. Инструкции см. в статье [Download .NET Core 2.2](https://dotnet.microsoft.com/download/dotnet-core/2.2) (Скачивание .NET Core 2.2). Убедитесь, что вы используете одну и ту же версию .NET Core на компьютере разработки и целевом сервере.

5. Вернитесь на портал Azure Stack и откройте порты в параметрах сети для виртуальной машины.

    1. Откройте портал Azure Stack для своего клиента.
    2. Найдите свою виртуальную машину. Вы могли прикрепить виртуальную машину к панели мониторинга. Вы можете найти виртуальную машину с помощью поля **Поиск ресурсов**.
    3. Выберите **Сети**.
    4. В разделе виртуальной машины выберите **Добавить правило входящего порта**.
    1. Добавьте правило безопасности для входящего трафика для следующих портов:

    | Порт | Протокол | ОПИСАНИЕ |
    | --- | --- | --- |
    | 80 | HTTP | Протокол передачи гипертекста (HTTP) — это прикладной протокол для распределенных, совместных информационных систем гиперсред. Клиенты будут подключаться к вашему веб-приложению с помощью общедоступного IP-адреса или DNS-имени вашей виртуальной машины. |
    | 443 | HTTPS | Протокол HTTPS является расширением протокола передачи гипертекста (HTTP). Он используется для безопасной связи через компьютерную сеть. Клиенты будут подключаться к вашему веб-приложению с помощью общедоступного IP-адреса или DNS-имени вашей виртуальной машины. |
    | 22 | SSH | Secure Shell (SSH) —это сетевой протокол шифрования, предназначенный для безопасного использования сетевых служб по незащищенной сети. Вы будете использовать это соединение с клиентом SSH для настройки виртуальной машины и развертывания приложений. |
    | 3389 | RDP | Необязательный элемент. Протокол удаленного рабочего стола позволяет выполнять подключение к удаленному рабочему столу, чтобы использовать графический пользовательский интерфейс вашего компьютера.   |

    Для каждого порта:

    1. Выберите значение **Любой** для источника.
    1. Введите `*` для диапазона исходных портов.
    1. Выберите значение **Любой** для параметра **Назначение**.
    1. Добавьте порт, который вы хотите открыть, для параметра **Диапазон портов назначения**.
    1. Выберите значение **Любой** для параметра **Протокол**.
    1. Выберите значение **Разрешить** для параметра **Действие**.
    1. Оставьте значение по умолчанию для параметра **Приоритет**.
    1. Укажите **имя** и **описание**, чтобы вы смогли записать причину открытия порта.
    1. Выберите "Добавить".

5.  В параметрах **Сеть** для своей виртуальной машины в Azure Stack создайте DNS-имя для сервера. Пользователи могут подключаться к веб-сайту по URL-адресу.

    1. Откройте портал Azure Stack для своего клиента.
    1. Найдите свою виртуальную машину. Вы могли прикрепить виртуальную машину к панели мониторинга. Вы можете найти виртуальную машину с помощью поля **Поиск ресурсов**.
    1. Щелкните **Обзор**.
    1. В разделе виртуальной машины выберите **Настроить**.
    1. Выберите значение **Динамический** для параметра **Назначение**.
    1. Введите метку имени DNS, например `mywebapp`, чтобы полный URL-адрес выглядел следующим образом: `mywebapp.local.cloudapp.azurestack.external`.

## <a name="create-an-app"></a>Создание приложения 

Вы можете использовать собственное веб-приложение или пример из статьи [Учебник. Начало работы с Razor Pages в ASP.NET Core](https://docs.microsoft.com/aspnet/core/tutorials/razor-pages/razor-pages-start?view=aspnetcore-2.2&tabs=visual-studio
).

В этой статье описывается, как создать веб-приложение ASP.NET и опубликовать его на виртуальную машину Azure с помощью функции публикации виртуальных машин Microsoft Azure в Visual Studio 2017. После установки приложения убедитесь, что оно запущено локально, и обновите цель публикации на виртуальной машине Windows в Azure Stack.

## <a name="deploy-and-run-the-app"></a>Развертывание и запуск приложения

Создайте цель публикации на виртуальной машине в Azure Stack.

1. Щелкните правой кнопкой мыши проект в обозревателе решений и выберите **Опубликовать**.

    ![Развертывание веб-приложения ASP.NET для публикации Azure Stack](media/azure-stack-dev-start-howto-vm-dotnet/deploy-app-to-azure-stack.png)

2.  В окне "Публикация" выберите "Создать профиль".
3. Выберите IIS, FTP и т. д.
4. Выберите "Публиковать".

5.  Выберите значение **Веб-развертывание** для параметра **Метод публикации**.
6.  Для параметра **Сервер** введите DNS-имя, заданное ранее, например `w21902.local.cloudapp.azurestack.external`.
7.  Для параметра **Имя сайта** введите `Default Web Site`.
8.  Для параметра **Имя пользователя** введите имя пользователя для компьютера.
9.  Для параметра **Пароль** введите пароль для компьютера.
10. Для параметра **URL-адрес назначения** введите URL-адрес для сайта, например `mywebapp.local.cloudapp.azurestack.external`.

    ![Развертывание веб-приложения ASP.NET — настройка веб-развертывания](media/azure-stack-dev-start-howto-vm-dotnet/configure-web-deploy.png)

9. Выберите **Проверить подключение**, чтобы проверить конфигурацию веб-развертывания. Затем щелкните **Далее**.
10. Задайте значение **Выпуск** для параметра **Конфигурация**.
11. Задайте значение **netcoreapp2.2** для параметра **Целевая платформа**.
12. Задайте значение **Переносимая** для параметра **Целевая среда выполнения**.
13. Щелкните **Сохранить**.
14. Нажмите кнопку **Опубликовать**.
15. Перейдите к новому серверу. Вы увидите запущенное веб-приложение.

```HTTP  
    mywebapp.local.cloudapp.azurestack.external
```

## <a name="next-steps"></a>Дополнительная информация

- Дополнительные сведения о разработке для Azure Stack см. [здесь](azure-stack-dev-start.md).
- Дополнительные сведения о распространенных сценариях развертывания IaaS для Azure Stack см. [здесь](azure-stack-dev-start-deploy-app.md).