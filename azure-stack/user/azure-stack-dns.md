---
title: DNS в Azure Stack | Документация Майкрософт
description: Использование DNS в Azure Stack
services: azure-stack
documentationcenter: ''
author: sethmanheim
manager: femila
ms.assetid: ''
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/05/2019
ms.author: sethm
ms.lastreviewed: 01/05/2019
ms.openlocfilehash: 278b010cd1883043549217d657e1315ea697a303
ms.sourcegitcommit: 7f39bdc83717c27de54fe67eb23eb55dbab258a9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/05/2019
ms.locfileid: "66691966"
---
# <a name="using-dns-in-azure-stack"></a>Использование DNS в Azure Stack

*Область применения: интегрированные системы Azure Stack и Пакет средств разработки Azure Stack*

Azure Stack поддерживает следующие возможности Azure DNS:

* Разрешение DNS-имен узлов
* Создание зон и записей DNS и управление ими с помощью API

## <a name="support-for-dns-hostname-resolution"></a>Разрешение DNS-имен узлов

Можно указать метку DNS-имени домена для ресурсов общедоступных IP-адресов. Azure Stack использует имя метки **domainnamelabel.location.cloudapp.azurestack.external** и сопоставляет его с общедоступным IP-адресом на DNS-серверах, управляемых Azure Stack.

Например, если вы создадите в локальном расположении Azure Stack ресурс с общедоступным IP-адресом и укажете для него метку доменного имени **contoso**, то [полное доменное имя](https://en.wikipedia.org/wiki/Fully_qualified_domain_name) **contoso.local.cloudapp.azurestack.external** будет разрешаться общедоступному IP-адресу этого ресурса. Это полное доменное имя можно указать в записи CNAME, которая указывает на общедоступный IP-адрес в Azure Stack.

Дополнительные сведения о разрешении имен см. в статье [Разрешение DNS](/azure/dns/dns-for-azure-services?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).

> [!IMPORTANT]
> Каждая создаваемая метка доменного имени должна быть уникальной в пределах своего расположения в Azure Stack.

На следующем снимке экрана показано диалоговое окно **Создать общедоступный IP-адрес** для создания общедоступного IP-адреса с помощью портала.

![Создание общедоступного IP-адреса](media/azure-stack-dns/image01.png)

### <a name="example-scenario"></a>Пример сценария

Предположим, что запросы от веб-приложения обрабатывает подсистема балансировки нагрузки. В зоне действия подсистемы балансировки нагрузки имеется веб-сайт, выполняемый на одной или нескольких виртуальных машинах. Вы можете обращаться к веб-сайту с балансировкой нагрузки по доменному имени вместо IP-адреса.

## <a name="create-and-manage-dns-zones-and-records-using-the-api"></a>Создание зон и записей DNS и управление ими с помощью API

В Azure Stack вы можете создавать зоны и записи DNS и управлять ими.

Azure Stack, как и Azure, предоставляет службу DNS. Интерфейсы API этой службы совпадают с интерфейсами API службы Azure DNS.  Размещая домены в службе DNS Azure Stack, вы можете управлять своими записями DNS с помощью тех же учетных данных, API и инструментов. Кроме того, можно оплачивать их использование и получать помощь, как и для других служб Azure.

Инфраструктура Azure Stack DNS более компактна, чем ее аналог в Azure. Размер и расположение развертывания Azure Stack влияет на область, масштаб и производительность службы DNS. Это также означает, что показатели производительности, доступности, глобального распространения и высокого уровня доступности будут зависеть от конкретного развертывания.

## <a name="comparison-with-azure-dns"></a>Сравнение с Azure DNS

DNS в Azure Stack похож на DNS в Azure, но существуют некоторые важные отличия между ними.

* **Записи AAAA не поддерживаются**. Azure Stack не поддерживает записи AAAA, так как Azure Stack не поддерживает IPv6-адреса. Это ключевое различие между службами DNS в Azure и Azure Stack.

* **Мультитенантность не поддерживается**. Служба DNS в Azure Stack не является мультитенантной. Это означает, что разные клиенты не смогут создать одинаковые зоны DNS. Успешной будет только первая попытка создать зону, а все последующие запросы завершатся ошибкой. Это еще одно ключевое различие между службами DNS в Azure и Azure Stack.

* **Теги, метаданные и теги ETag**. Существует несколько незначительных различий в том, как Azure Stack обрабатывает теги, метаданные, теги ETag и ограничения.

Чтобы узнать больше о Azure DNS, ознакомьтесь с [зонами и записями DNS](/azure/dns/dns-zones-records).

### <a name="tags"></a>Теги

Azure Stack DNS поддерживает использование тегов Azure Resource Manager в ресурсах зоны DNS. При этом использование тегов в наборе записей DNS не поддерживается. Вместо этого в наборе записей DNS можно использовать **метаданные**, как описано в следующем разделе.

### <a name="metadata"></a>Метаданные

Вместо тегов для наборов записей Azure Stack DNS поддерживает создание заметок с помощью *метаданных*. Так же как и теги, метаданные позволяют связывать пары "имя — значение" с каждым набором записей. К примеру, это позволяет указать назначение каждого набора записей. В отличие от тегов, метаданные нельзя использовать, чтобы обеспечить отфильтрованное представление счетов Azure, и указывать в политике Azure Resource Manager.

### <a name="etags"></a>Теги Etag

Предположим, что два человека или два процесса пробуют изменить запись DNS одновременно. У какого из них это получится? И будет ли этот человек или процесс знать, что они заменили изменения кого-то другого?

Служба Azure Stack DNS использует теги *ETag* для безопасной обработки параллельных изменений одного ресурса. Теги ETag не связаны с *тегами* Azure Resource Manager. С каждым ресурсом DNS (зоной или набором записей) связан Etag. При извлечении ресурса также передается его значение Etag. При обновлении ресурса вы можете вернуть ETag, чтобы служба Azure Stack DNS могла сопоставить его с ETag на сервере. Так как каждое обновление ресурса приводит к повторному созданию Etag, несовпадение Etag указывает на параллельное изменение. Теги Etag можно также использовать при создании ресурса для проверки того, что ресурс не существует.

По умолчанию командлеты PowerShell для Azure Stack DNS используют теги ETag для защиты от одновременных изменений зон и наборов записей. Вы можете использовать необязательный параметр `-Overwrite`, чтобы отключить проверки тегов Etag. В этом случае все одновременные изменения перезаписываются.

На уровне REST API службы Azure Stack DNS теги ETag указываются с помощью заголовков HTTP. Их поведение описывается в следующей таблице:

| Заголовок | Поведение|
|--------|---------|
| Нет   | PUT всегда завершается успешно (без проверки Etag)|
| If-match| PUT завершается успешно, только если ресурс существует и Etag соответствует|
| If-match *| PUT завершается успешно, только если ресурс существует|
| If-none-match*| PUT завершается успешно, только если ресурс не существует|

### <a name="limits"></a>Ограничения

При использовании Azure Stack DNS по умолчанию применяются следующие ограничения:

| Ресурс| Ограничение по умолчанию|
|---------|--------------|
| Зон на подписку| 100|
| Наборов записей на зону| 5000|
| Записей на набор записей| 20|

## <a name="next-steps"></a>Дополнительная информация

* [Общие сведения об iDNS для Azure Stack](azure-stack-understanding-dns.md)
