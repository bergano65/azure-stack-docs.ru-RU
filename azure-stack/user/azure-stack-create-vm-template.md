---
title: Создание виртуальной машины с использованием шаблона сообщества
description: Из этой статьи вы узнаете, как с помощью Пакета средств разработки Azure Stack создать виртуальную машину, используя стандартный шаблон и пользовательский шаблон с сайта GitHub.
author: sethmanheim
ms.topic: tutorial
ms.date: 01/23/2020
ms.author: sethm
ms.reviewer: unknown
ms.lastreviewed: 11/13/2019
ms.openlocfilehash: 9e8df158444b0cbb2b6efaea6f99766f36b26241
ms.sourcegitcommit: 4ac711ec37c6653c71b126d09c1f93ec4215a489
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/27/2020
ms.locfileid: "77704341"
---
# <a name="tutorial-create-a-vm-using-a-community-template"></a>Руководство по Создание виртуальной машины с использованием шаблона сообщества

Оператор или пользователь Azure Stack Hub может создать виртуальную машину с помощью [настраиваемых шаблонов GitHub для быстрого запуска](https://github.com/Azure/AzureStack-QuickStart-Templates), а не развертывать шаблоны вручную из Azure Stack Hub Marketplace.

В этом руководстве описано следующее:

> [!div class="checklist"]
> * Использование шаблонов быстрого запуска Azure Stack Hub
> * Создание виртуальной машины с помощью настраиваемого шаблона GitHub
> * Запуск Minikube и установка приложения

## <a name="azure-stack-hub-quickstart-templates"></a>Шаблоны быстрого запуска Azure Stack Hub

Шаблоны быстрого запуска Azure Stack Hub хранятся в [соответствующем глобальном репозитории](https://github.com/Azure/AzureStack-QuickStart-Templates) в GitHub. Этот репозиторий содержит шаблоны развертывания Azure Resource Manager, которые были протестированы с помощью Пакета средств разработки Microsoft Azure Stack (ASDK). С их помощью вы можете упростить оценку Azure Stack Hub и использование среды ASDK.

Многие пользователи GitHub в течение некоторого времени пополняли репозиторий, в результате чего мы имеем коллекцию из более чем 400 шаблонов развертывания. Это хорошая отправная точка, которая поможет вам понять, как развертывать различные среды в Azure Stack Hub.

>[!IMPORTANT]
> Некоторые из этих шаблонов создаются членами сообщества, а не корпорацией Майкрософт. Каждый шаблон лицензирован для вас в соответствии с условиями лицензионного соглашения с владельцем, а не с корпорацией Майкрософт. Корпорация Майкрософт не несет ответственности за шаблоны и не отслеживает их безопасность, совместимость или производительность. Шаблоны, созданные сообществом, не поддерживаются ни в соответствии с какой-либо программой поддержки Майкрософт, ни какими-либо службами поддержки Майкрософт и предоставляются КАК ЕСТЬ без каких-либо гарантий.

Если вы хотите добавить шаблоны Azure Resource Manager на сайт GitHub, воспользуйтесь репозиторием [AzureStack-QuickStart-Templates](https://github.com/Azure/AzureStack-QuickStart-Templates). Чтобы узнать больше об этом репозитории и о том, как пополнять его, изучите [файл сведений](https://aka.ms/aa6zktg).

## <a name="create-a-vm-using-a-custom-github-template"></a>Создание виртуальной машины с помощью настраиваемого шаблона GitHub

В рамках этого руководстве используется шаблон быстрого запуска Azure Stack Hub [101-vm-linux-minikube](https://github.com/Azure/AzureStack-QuickStart-Templates/tree/master/101-vm-linux-minikube) для развертывания виртуальной машины с Ubuntu 16.04 в Azure Stack Hub, которая использует Minikube для управления кластером Kubernetes.

Minikube — это средство, которое позволяет легко запускать Kubernetes локально. Minikube запускает одноузловой кластер Kubernetes внутри виртуальной машины, это позволяет опробовать Kubernetes или использовать его для ежедневной разработки. Он поддерживает простой кластер Kubernetes с одним узлом, работающий на виртуальной машине Linux. Minikube — это самый быстрый и прямой способ получить полностью функциональный кластер Kubernetes. Он позволяет разрабатывать и тестировать развертывания приложений на основе Kubernetes на своих локальных машинах. С точки зрения архитектуры компоненты главного узла и узла агента выполняются локально на виртуальной машине Minikube:

* Компоненты главного узла, такие как сервер API, планировщик и [сервер etcd](https://coreos.com/etcd/), запускаются в одном Linux-процессе под названием **LocalKube**.
* Компоненты агента узла запускаются внутри контейнеров Docker так же, как и на обычном узле агента. С точки зрения развертывания приложения нет разницы, развертывается ли приложение в Minikube или в обычном кластере Kubernetes.

Этот шаблон устанавливает следующие компоненты:

* виртуальная машина Ubuntu 16.04 LTS;
* [Docker-CE](https://download.docker.com/linux/ubuntu);
* [Kubectl](https://storage.googleapis.com/kubernetes-release/release/v1.8.0/bin/linux/amd64/kubectl)
* [Minikube](https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64)
* xFCE4;
* xRDP.

> [!IMPORTANT]
> Прежде чем приступить к выполнению этих шагов, убедитесь, что образ виртуальной машины Ubuntu (Ubuntu Server 16.04 LTS в этом примере) уже добавлен в Azure Stack Hub Marketplace.

1. Выберите **Создать ресурс**, а затем — **Пользовательский** и **Развертывание шаблона**.

    ![Создание шаблона](media/azure-stack-create-vm-template/1.PNG)

2. Выберите **Изменить шаблон**.

    ![Изменение шаблона](media/azure-stack-create-vm-template/2.PNG)

3. Выберите **Шаблон быстрого запуска**.

    ![Шаблон быстрого запуска](media/azure-stack-create-vm-template/3.PNG)

4. Выберите **101-vm-linux minikube** из доступных шаблонов, используя раскрывающийся список **Select a template** (Выберите шаблон), а затем нажмите кнопку **ОК**.

    ![Выберите шаблон](media/azure-stack-create-vm-template/4.PNG)

5. При необходимости вы можете внести изменения в JSON-файл шаблона. Если вы не хотите вносить изменения или уже внесли их, нажмите кнопку **Сохранить**, чтобы закрыть диалоговое окно **Изменение шаблона**.

    ![Сохранение шаблона](media/azure-stack-create-vm-template/5.PNG)

6. Щелкните **Параметры**, заполните или измените доступные поля и нажмите кнопку **ОК**.

    ![Параметры](media/azure-stack-create-vm-template/6.PNG)

7. Выберите нужную подписку, после чего создайте группу ресурсов или выберите готовую. Нажмите кнопку **Создать**, чтобы начать развертывание шаблона.

    ![Выбор подписки](media/azure-stack-create-vm-template/7.PNG)

8. Развертыванию группы ресурсов требуется несколько минут для создания настраиваемой виртуальной машины на основе шаблона. Вы можете контролировать состояние установки с помощью уведомлений и в свойствах группы ресурсов.

    ![Развертывание](media/azure-stack-create-vm-template/8.PNG)

    >[!NOTE]
    > После развертывания будет запущена виртуальная машина.

## <a name="start-minikube-and-install-an-application"></a>Запуск Minikube и установка приложения

Теперь, когда виртуальная машина Linux была успешно создана, вы можете войти в систему, чтобы запустить Minikube и установить приложение.

1. После развертывания нажмите кнопку **Подключить**, чтобы просмотреть общедоступный IP-адрес, который будет использоваться для подключения к виртуальной машине Linux.

    ![Подключение](media/azure-stack-create-vm-template/9.PNG)

2. В командной строке с повышенными привилегиями запустите файл **mstsc.exe**, чтобы открыть подключение к удаленному рабочему столу и подключиться к общедоступному IP-адресу виртуальной машины Linux, обнаруженному на предыдущем шаге. При появлении запроса на вход в xRDP используйте учетные данные, указанные при создании виртуальной машины.

    ![Remote](media/azure-stack-create-vm-template/10.PNG)

3. Откройте эмулятор терминала и введите следующие команды для запуска Minikube:

    ```shell
    sudo minikube start --vm-driver=none
    sudo minikube addons enable dashboard
    sudo minikube dashboard --url
    ```

    ![Выполнение команд](media/azure-stack-create-vm-template/11.PNG)

4. Откройте веб-браузер и перейдите на страницу панели мониторинга Kubernetes. Поздравляем! Теперь у вас есть полностью работающая установка Kubernetes, использующая Minikube!

    ![Панель мониторинга](media/azure-stack-create-vm-template/12.PNG)

5. Чтобы развернуть пример приложения, зайдите на официальную страницу документации по Kubernetes и пропустите раздел "Create Minikube Cluster" (Создание кластера Minikube), так как вы уже создали его. Перейдите в раздел "Create your Node.js application" (Создание приложения Node.js) на странице https://kubernetes.io/docs/tutorials/stateless-application/hello-minikube/.

## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве вы узнали, как выполнять следующие задачи:

> [!div class="checklist"]
> * Сведения о шаблонах быстрого запуска Azure Stack Hub
> * Создание виртуальной машины с помощью настраиваемого шаблона GitHub
> * Запуск minikube и установка приложения
