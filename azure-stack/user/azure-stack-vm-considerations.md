---
title: Возможности виртуальных машин Azure Stack Hub
description: Узнайте о возможностях виртуальных машин и рекомендациях по работе с ними в Azure Stack Hub.
author: mattbriggs
ms.topic: article
ms.date: 2/3/2020
ms.author: mabrigg
ms.reviewer: kivenkat
ms.lastreviewed: 10/09/2019
ms.openlocfilehash: ba6e4483475b97b6803781f5b7c5d29d94cbe896
ms.sourcegitcommit: 4ac711ec37c6653c71b126d09c1f93ec4215a489
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/27/2020
ms.locfileid: "77705140"
---
# <a name="azure-stack-hub-vm-features"></a>Возможности виртуальных машин Azure Stack Hub

Виртуальные машины Azure Stack Hub — это масштабируемые вычислительные ресурсы, предоставляемые по запросу. Перед развертыванием виртуальных машин следует изучить различия между функциями виртуальных машин в Azure Stack Hub и Microsoft Azure. В этой статье описаны разные возможности и представлены основные рекомендации по планированию развертывания виртуальных машин. Чтобы узнать об общих различиях между Azure Stack Hub и Azure, прочитайте [эту статью](azure-stack-considerations.md).

## <a name="vm-differences"></a>Сравнение возможностей

| Компонент | Azure (глобальная) | Azure Stack Hub |
| --- | --- | --- |
| Образы виртуальных машин | Azure Marketplace содержит образы, на основе которых можно создать виртуальную машину. На странице [Azure Marketplace](https://azuremarketplace.microsoft.com/en-us/marketplace/apps/category/compute?subcategories=virtual-machine-images&page=1) представлен список образов, доступных в Azure Marketplace. | По умолчанию Azure Stack Hub Marketplace не содержит образов. Чтобы пользователи могли использовать образы, администратору облака Azure Stack Hub нужно опубликовать или скачать их в Azure Stack Hub Marketplace. |
| Поколение VHD | Виртуальные машины 2-го поколения поддерживают ключевые функции, которые не поддерживаются в 1-м поколении. Эти функции включают увеличенную память, Intel Software Guard Extensions и виртуализированную постоянную память (vPMEM). Виртуальные машины 2-го поколения, работающие в локальной среде, поддерживают некоторые функции, которые еще не поддерживаются в Azure. См. сведения о [поддержке виртуальных машин 2-го поколения в Azure.](https://docs.microsoft.com/azure/virtual-machines/windows/generation-2)  | В Azure Stack Hub поддерживается только виртуальные машины 1-го поколения. Виртуальную машину 1-го поколения можно преобразовать из формата VHDX в формат VHD, а также переключить с динамически расширяемого диска на диск фиксированного размера. Вы не можете изменить поколение виртуальной машины. См. сведения о [поддержке 2-го поколения виртуальных машин в Azure.](https://docs.microsoft.com/azure/virtual-machines/windows/generation-2) |
| Размер виртуальных машин | Azure поддерживает разные размеры виртуальных машин. См. дополнительные сведения о размерах виртуальных машин [Windows](/azure/virtual-machines/virtual-machines-windows-sizes) и [Linux](/azure/virtual-machines/linux/sizes). | Azure Stack Hub поддерживает различные размеры виртуальных машин, доступных в Azure. См. [список поддерживаемых размеров виртуальных машин](#vm-sizes), приведенный в этой статье. |
| Квоты для виртуальных машин | [Ограничения квот](/azure/azure-subscription-service-limits#service-specific-limits) устанавливаются корпорацией Майкрософт. | Администратору облака Azure Stack Hub нужно назначить квоты, прежде чем предлагать виртуальные машины пользователям. |
| Расширения виртуальных машин |Azure поддерживает разные расширения виртуальных машин. См. дополнительные сведения о [расширениях и компонентах виртуальных машин](/azure/virtual-machines/windows/extensions-features).| Azure Stack Hub поддерживает различные расширения, доступные в Azure, каждое из которых представлено в конкретных версиях. Администратор облака Azure Stack Hub может выбрать, какие расширения будут доступны его пользователям. См. список поддерживаемых расширений в разделе [Расширения виртуальных машин](#vm-extensions) в этой статье. |
| Сетевые ресурсы виртуальных машин | Общедоступные IP-адреса, назначенные для виртуальной машины арендатора, доступны через Интернет.<br><br><br>Виртуальные машины Azure имеют фиксированное DNS-имя. | Общедоступные IP-адреса, назначенные виртуальной машине арендатора, доступны только в пределах среды Пакета средств разработки Azure Stack. Пользователь должен иметь доступ к Пакету средств разработки Azure Stack через [RDP](../asdk/asdk-connect.md#connect-to-azure-stack-using-rdp) или [VPN](../asdk/asdk-connect.md#connect-to-azure-stack-using-vpn), чтобы подключиться к виртуальной машине, созданной в Azure Stack Hub.<br><br>Виртуальные машины, созданные в определенном экземпляре Azure Stack Hub, получают DNS-имя в соответствии со значениями, заданными администратором облака. |
| Хранилище для виртуальных машин | Поддерживаются [управляемые диски.](/azure/virtual-machines/windows/managed-disks-overview) | Управляемые диски поддерживаются в Azure Stack Hub версии 1808 и выше. |
| Производительность дисков виртуальной машины | Зависит от типа и размера диска. | Зависит от размера виртуальной машины, к которой подключены диски. См. дополнительные сведения о [поддерживаемых размерах виртуальных машин в Azure Stack Hub](azure-stack-vm-sizes.md).
| Версии API | Azure всегда использует последние версии API для всех компонентов виртуальной машины. | Azure Stack Hub поддерживает только определенные службы Azure и конкретные версии API для каждой из этих служб. Чтобы просмотреть список поддерживаемых версий API, изучите раздел [Версии API](#api-versions) в этой статье. |
| Служба метаданных экземпляров Azure | Служба метаданных экземпляров Azure предоставляет сведения о выполняемых экземплярах виртуальных машин, которые можно использовать для настройки вашей виртуальной машины и управления ею.  | Служба метаданных экземпляров Azure не поддерживается в Azure Stack Hub. |
| Группы доступности виртуальных машин|Несколько доменов сбоя (2 или 3 в каждом регионе).<br>Несколько доменов обновления.|Несколько доменов сбоя (2 или 3 в каждом регионе).<br>Один домен обновления с динамической миграцией для защиты рабочих нагрузок во время обновления. 20 доменов обновления поддерживаются для обеспечения совместимости шаблонов.<br>Виртуальная машина и группа доступности должны находиться в одном расположении и группе ресурсов.|
| Масштабируемые наборы виртуальных машин|Поддержка автоматического масштабирования.|Отсутствие поддержки автоматического масштабирования.<br><br>В масштабируемый набор можно добавить дополнительные экземпляры с помощью портала, шаблонов Resource Manager или PowerShell. |
| Облако-свидетель. | Выберите конечные точки в свойствах учетной записи хранения, доступных в Azure Stack Hub. | [Облако-свидетель](https://docs.microsoft.com/windows-server/failover-clustering/deploy-cloud-witness) — это разновидность следящего сервера кворума отказоустойчивого кластера, который использует Microsoft Azure для передачи голоса для кворума кластера.<br>Сравнение конечных точек в глобальной среде Azure и в Azure Stack Hub выглядит следующим образом.<br>Глобальная среда Azure:<br>`https://mywitness.blob.core.windows.net/`<br>Azure Stack Hub:<br>`https://mywitness.blob.<region>.<FQDN>/`|
| Диагностика виртуальной машины | Поддержка диагностики виртуальных машин Linux. | Диагностика виртуальных машин Linux не поддерживается в Azure Stack Hub. При развертывании виртуальной машины Linux с включенной диагностикой оно завершается со сбоем. Развертывание также не выполняется, если базовые метрики виртуальной машины Linux включены через параметры диагностики. |

## <a name="vm-sizes"></a>Размеры виртуальной машины

В Azure Stack Hub используются ограничения ресурсов. Это предотвращает их чрезмерное использование (на уровне локальных серверов и служб). Эти ограничения улучшают работу клиентов, уменьшая влияние других клиентов на потребление ресурсов.

- Для исходящего трафика виртуальной машины предусмотрены ограничения пропускной способности. Ограничения в Azure Stack Hub аналогичны ограничениям в Azure.
- Для ресурсов хранилища в Azure Stack Hub применяются ограничения на число операций ввода-вывода в секунду. Это предотвращает чрезмерное использование ресурсов хранилища клиентами.
- В Azure Stack Hub доступное количество операций ввода-вывода в секунду для дисков виртуальной машины зависит от размера этой виртуальной машины, а не от типа диска. Это означает, что для виртуальной машины серии Standard_Fs, независимо от того, выбираете ли вы SSD или HDD в качестве типа диска, ограничение операций ввода-вывода в секунду для второго диска данных составляет 2300 операций ввода-вывода в секунду.

В следующей таблице перечислены поддерживаемые в Azure Stack Hub виртуальные машины и их конфигурации:

| Тип            | Размер          | Диапазон поддерживаемых размеров |
| ----------------| ------------- | ------------------------ |
|Общего назначения  |Basic A        |[A0–A4](azure-stack-vm-sizes.md#basic-a)                   |
|Общего назначения  |Standard A     |[A0–A7](azure-stack-vm-sizes.md#standard-a)              |
|Общего назначения  |Серия Av2     |[A1_v2–A8m_v2](azure-stack-vm-sizes.md#av2-series)     |
|Общего назначения  |Серия D       |[D1–D4](azure-stack-vm-sizes.md#d-series)              |
|Общего назначения  |Серия Dv2     |[D1_v2–D5_v2](azure-stack-vm-sizes.md#ds-series)        |
|Общего назначения  |Серия DS      |[DS1–DS4](azure-stack-vm-sizes.md#dv2-series)            |
|Общего назначения  |Серия DSv2    |[DS1_v2–DS5_v2](azure-stack-vm-sizes.md#dsv2-series)      |
|Оптимизированные для операций в памяти |Серия D       |[D11–D14](azure-stack-vm-sizes.md#mo-d)            |
|Оптимизированные для операций в памяти |Серия DS      |[DS11–DS14](azure-stack-vm-sizes.md#mo-ds)|
|Оптимизированные для операций в памяти |Серия Dv2     |[D11_v2–DS14_v2](azure-stack-vm-sizes.md#mo-dv2)     |
|Оптимизированные для операций в памяти |Серия DSv2    |[DS11_v2–DS14_v2](azure-stack-vm-sizes.md#mo-dsv2)    |
|Оптимизированные для вычислений|Серия F       |[F1 - F16](azure-stack-vm-sizes.md#f-series)    |
|Оптимизированные для вычислений|Серия Fs      |[F1s - F16s](azure-stack-vm-sizes.md#fs-series)    |
|Оптимизированные для вычислений|Серия Fsv2    |[F2s_v2–F64s_v2](azure-stack-vm-sizes.md#fsv2-series)    |

Размеры виртуальных машин и объемы связанных с ними ресурсов в Azure Stack Hub и Azure полностью совпадают. Это относится к объему памяти, количеству ядер, а также количеству и размерам создаваемых дисков данных. Однако фактическая производительность виртуальных машин зависит от базовых характеристик конкретной среды Azure Stack Hub.

## <a name="vm-extensions"></a>Расширения виртуальных машин

Azure Stack Hub включает небольшой набор расширений. Обновления и дополнительные расширения доступны посредством синдикации marketplace.

Получите список расширений виртуальной машины, доступных в среде Azure Stack Hub, с помощью следующего скрипта PowerShell:

```powershell
Get-AzureRmVmImagePublisher -Location local | `
  Get-AzureRmVMExtensionImageType | `
  Get-AzureRmVMExtensionImage | `
  Select Type, Version | `
  Format-Table -Property * -AutoSize
```

Если подготовка расширения для развертывания виртуальной машины занимает слишком много времени, нужно дождаться истечения времени ожидания, а не пытаться остановить процесс освобождения или удаления виртуальной машины.

## <a name="api-versions"></a>Версии API

Компоненты виртуальных машин в Azure Stack Hub поддерживают следующие версии API:

2017-12-01, 2017-03-30, 2016-03-30, 2015-06-15

Получите список версий API для компонентов виртуальной машины, доступных в вашей среде Azure Stack Hub, с помощью следующего скрипта PowerShell:

```powershell
Get-AzureRmResourceProvider | `
  Select ProviderNamespace -Expand ResourceTypes | `
  Select * -Expand ApiVersions | `
  Select ProviderNamespace, ResourceTypeName, @{Name="ApiVersion"; Expression={$_}} | `
  where-Object {$_.ProviderNamespace -like "Microsoft.compute"}
```

Список поддерживаемых типов ресурсов и версий API может измениться, если оператор облака обновит среду Azure Stack Hub до более новой версии.

## <a name="windows-activation"></a>Активация Windows

Продукты Windows необходимо использовать в соответствии с правами на использование продуктов и условиями лицензии Майкрософт. Azure Stack Hub использует [автоматическую активацию виртуальных машин](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn303421(v%3dws.11)) для активации виртуальных машин Windows Server.

- Узел Azure Stack Hub активирует Windows с помощью ключей AVMA для Windows Server 2016. Все виртуальные машины под управлением Windows Server 2012 R2 или более поздней версии активируются автоматически.
- Виртуальные машины под управлением Windows Server 2012 не активируются автоматически. Их нужно активировать с помощью [MAK](https://technet.microsoft.com/library/ff793438.aspx). Чтобы использовать активацию с помощью MAK, необходимо указать ключ продукта.

Microsoft Azure использует сервер управления ключами для активации виртуальных машин Windows. Если вы переносите виртуальную машину из Azure Stack Hub в Azure и у вас возникают проблемы при активации, см. дополнительные сведения об [устранении неполадок с активацией виртуальных машин Windows в Azure](https://docs.microsoft.com/azure/virtual-machines/windows/troubleshoot-activation-problems). См. дополнительные сведения в записи блога группы поддержки Azure об [устранении неполадок с активацией Windows на виртуальных машинах Azure](https://blogs.msdn.microsoft.com/mast/2017/06/14/troubleshooting-windows-activation-failures-on-azure-vms/).

## <a name="next-steps"></a>Дальнейшие действия

[Создание виртуальной машины Windows с помощью PowerShell в Azure Stack Hub](azure-stack-quick-create-vm-windows-powershell.md)
