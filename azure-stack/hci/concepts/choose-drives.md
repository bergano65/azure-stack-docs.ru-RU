---
title: Выбор дисков для Azure Stack HCI
description: Сведения о выборе дисков для Локальных дисковых пространств в Azure Stack HCI
author: khdownie
ms.author: v-kedow
ms.topic: article
ms.date: 03/06/2020
ms.openlocfilehash: 42fb0703ed1e4947a1f35cc14a8708c8372f220e
ms.sourcegitcommit: 900332596d0bb473d82b1d1a28c3fe3aa6522add
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/11/2020
ms.locfileid: "79095211"
---
# <a name="choosing-drives-for-azure-stack-hci"></a>Выбор дисков для Azure Stack HCI

>Область применения: Windows Server 2019

В этой статье содержатся рекомендации по выбору дисков для [Локальных дисковых пространств](/windows-server/storage/storage-spaces/storage-spaces-direct-overview) в зависимости от требований к производительности и емкости, предъявляемых к Azure Stack HCI.

## <a name="drive-types"></a>Типы дисков

В настоящее время Локальные дисковые пространства работают с тремя типами носителей.

|||
|----------------------|--------------------------|
|![NVMe](media/choose-drives/NVMe-100-px.png)|**NVMe** (Non-Volatile Memory Express) — твердотельные накопители, подключаемые непосредственно к шине PCIe. Распространенные форм-факторы: 2,5" U.2, PCIe-in-Card (AIC) и M.2. NVMe предлагает более высокую скорость операций ввода-вывода и пропускную способность с более низкой задержкой, чем любой другой диск из числа поддерживаемых на этот момент.|
|![SSD](media/choose-drives/SSD-100-px.png)|**SSD** — твердотельные накопители, которые подключаются через традиционную технологию SATA или SAS.|
|![HDD](media/choose-drives/HDD-100-px.png)|**HDD** — жесткие диски с вращающимися магнитными пластинами, которые обеспечивают большой объем хранилища.|

## <a name="built-in-cache"></a>Встроенный кэш

Локальные дисковые пространства содержат встроенный серверный кэш. Это большой и сохраняемый кэш для операций чтения и записи в режиме реального времени. В развертываниях с одним или несколькими типами дисков он автоматически использует все диски самого "быстрого" типа. Остальные диски используются для хранения.

Подробнее см. [статью о кэшировании в Локальных дисковых пространствах](/windows-server/storage/storage-spaces/understand-the-cache).

## <a name="option-1--maximizing-performance"></a>Вариант 1. Максимизация производительности

Чтобы обеспечить прогнозируемую и постоянную задержку на уровне менее 1 мс для случайных операций чтения и записи любых данных, обеспечить чрезвычайно высокую скорость операций ввода-вывода в секунду (нам удалось достичь [свыше 6 000 000](https://www.youtube.com/watch?v=0LviCzsudGY&t=28m)!) или пропускную способность ввода-вывода (нам удалось достичь [свыше 1 ТБ в](https://www.youtube.com/watch?v=-LK2ViRGbWs&t=16m50s)!), используйте конфигурацию "только флэш-диски".

Сейчас для этого есть три возможности:

![Возможности развертывания только на флэш-дисках](media/choose-drives/All-Flash-Deployment-Possibilities.png)

1. **Только NVMe.** Использование только NVMe обеспечивает непревзойденную производительность, в том числе наиболее предсказуемую низкую задержку. Если выбраны диски только одной модели, кэш отсутствует. Вы также можете сочетать разные модели NVMe с разной устойчивостью к износу, и настроить кэш операций записи на дисках с большей устойчивостью ([требует настройки](/windows-server/storage/storage-spaces/understand-the-cache#manual-configuration)).

2. **NVMe и SSD.** Если выбраны диски NVMe вместе с SSD, NVMe автоматически назначаются для кэширования операций записи на SSD. Это позволяет накапливать операции записи в кэше и синхронизировать их по мере необходимости, чтобы снизить износ дисков SSD. Это позволяет сохранить характеристики записи на уровне NVMe, обслуживая операции чтения напрямую с SSD, которые не намного медленнее.

3. **Только SSD.** Как и для дисков NVMe, если выбраны диски только одной модели, кэш отсутствует. Можно сочетать разные модели с разной устойчивостью к износу, и настроить кэш операций записи на дисках с большей устойчивостью ([требует настройки](/windows-server/storage/storage-spaces/understand-the-cache.md#manual-configuration)).

   >[!NOTE]
   > Использование только NVMe или SSD без выделенного кэша удобно тем, что хранилище использует полезную емкость каждого диска. Никакая часть емкости не "тратится" на кэш, что иногда очень выгодно в системах небольшого размера.

## <a name="option-2--balancing-performance-and-capacity"></a>Вариант 2. Баланс производительности и емкости

Для сред с несколькими разными приложениями и рабочими нагрузками, часть из которых очень чувствительны к производительности, а другим нужен значительный объема хранилища, можно применить "гибридный" подход, сочетая диски кэширования NVMe или SSDs с жесткими дисками большего объема.

![Возможности гибридного развертывания](media/choose-drives/Hybrid-Deployment-Possibilities.png)

1. **NVMe и HDD.** Диски NVMe будут ускорять операции чтения и записи путем кэширования. Кэширование операций чтения позволяет сориентировать использование жестких дисков для операций записи. Кэширование операций записи поглощает пики нагрузки и позволяет выполнять операции объединенными блоками, синхронизируя по мере необходимости, принудительно создавая последовательные пакеты записи, максимально повышающие пропускную способность и скорость операций ввода-вывода в секунду. Это позволяет сохранить характеристики, как у дисков NVMe, для всех операций записи и операций чтения часто используемых или недавно прочитанных данных.

2. **SSD и HDD.** Как и в варианте выше, диски SSD будут ускорять операции чтения и записи путем кэширования. Это позволяет сохранить характеристики, как у дисков SSD, для всех операций записи и чтения часто используемых или недавно прочитанных данных.

    Есть и еще один, нетривиальный вариант: использовать диски *всех трех типов*.

3. **NVMe, SSD и HDD.** Если в развертывании присутствуют диски всех трех типов, диски NVMe выполняют роль кэша для дисков SSD и дисков HDD. Это удобно тем, что вы можете создать в одном кластере часть томов на дисках SSD и другую часть — на HDD, для всех применяя ускорение с помощью NVMe. В первом из этих сочетаний все работает точно так же, как в развертывании "только флэш-диски", а во втором — как в "гибридных" развертываниях, описанных выше. Такая архитектура почти аналогична двум пулам с раздельным управлением емкостью, циклами сбоев и восстановления и т. д.

   >[!IMPORTANT]
   > Мы рекомендуем размещать наиболее чувствительные к производительности рабочие нагрузки только на дисках SSD.

## <a name="option-3--maximizing-capacity"></a>Вариант 3. Максимизация емкости

Для рабочих нагрузок, требующих большой емкости с нечастыми операциями записи, например для хранения архивов, резервного копирования, использования хранилища данных или автономного неструктурированного защищенного хранилища, можно объединить несколько твердотельных накопителей для кэширования с большим количеством больших жестких дисков для емкости.

![Варианты развертывания для максимизации емкости](media/choose-drives/maximizing-capacity.png)

1. **SSD и HDD.** Диски SSD кэшируют операции чтения и записи, чтобы сгладить пиковые нагрузки и предоставить высокие характеристики записи, как у твердотельных накопителей, оптимизируя отложенную синхронизацию с жесткими дисками.

>[!IMPORTANT]
>Конфигурация только с дисками HDD не поддерживается. Конфигурация SSD, в которой диски с меньшей устойчивостью к износу выполняют роль кэша для дисков с большей устойчивостью к износу, не рекомендуется к использованию.

## <a name="sizing-considerations"></a>Замечания о выборе размера

### <a name="cache"></a>Кэш

На каждом сервере должно быть по меньшей мере два диска кэша (это минимум, необходимый для обеспечения избыточности). Мы рекомендуем поддерживать количество дисков емкости, кратное количеству дисков кэша. Например, если вы используете четыре диска кэша, производительность кластера с восемью дисками емкости (соотношение "1 к 2") будет более равномерной, чем с семью или девятью.

Размер кэша следует подбирать так, чтобы он соответствовал объему рабочих данных ваших приложений и рабочих нагрузок, то есть объему активно считываемых или записываемых данных в конкретный момент. Других требований к размеру кэша не существует. Для развертываний с жестких дисками можно взять за основу кэш размером 10 % от емкости пула. Например, если на каждом сервере есть четыре диска HDD по 4 ТБ = 16 ТБ емкости, то для кэша настройте два диска SSD по 800 ГБ = 1,6 ТБ. Для развертываний только на флэш-дисках, особенно если это [диски SSD с очень высокой устойчивостью к износу](https://blogs.technet.microsoft.com/filecab/2017/08/11/understanding-dwpd-tbw/), можно взять за основу кэш размером 5 % от емкости пула. Например, если на каждом сервере есть 24 диска HDD по 1,2 ТБ = 28,8 ТБ емкости, то для кэша настройте 2 диска SSD по 750 ГБ = 1,5 ТБ. Вы всегда сможете добавить или удалить диски кэша позже.

### <a name="general"></a>Общие сведения

Мы рекомендуем использовать для каждого сервера не более 400 ТБ общей емкости пула. Чем больше емкость хранилища для одного сервера, тем больше времени нужно для синхронизации данных после любого простоя или перезагрузки, например после установки обновлений программного обеспечения. Текущий максимальный размер для пула носителей на Windows Server 2019 составляет 4 ПБ (петабайт) (= 4000 ТБ).

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения см. также в следующих разделах:

- [Общие сведения об Azure Stack HCI](../overview.md)
- [Основные сведения о кэше в Azure Stack HCI](cache.md)
- [Требования к оборудованию для Локальных дисковых пространств](/windows-server/storage/storage-spaces/storage-spaces-direct-hardware-requirements)
- [Планирование томов в Azure Stack HCI](plan-volumes.md)
- [Отказоустойчивость и эффективность хранилища](fault-tolerance.md)