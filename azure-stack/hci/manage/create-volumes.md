---
title: Создание томов в Azure Stack HCI
description: Сведения о том, как создавать тома в Azure Stack HCI с помощью Windows Admin Center и PowerShell.
author: khdownie
ms.author: v-kedow
ms.topic: article
ms.date: 02/28/2020
ms.openlocfilehash: b195a55314935282f43f99bf02bda1d2bc298b54
ms.sourcegitcommit: 1fa0140481a483e5c27f602386fe1fae77ad29f7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2020
ms.locfileid: "78370441"
---
# <a name="creating-volumes-in-azure-stack-hci"></a>Создание томов в Azure Stack HCI

> Область применения: Windows Server 2019

В этой статье описывается, как создавать тома в кластере Локальных дисковых пространств с помощью Windows Admin Center и Windows PowerShell, как работать с файлами в этих томах и как включить дедупликацию данных и сжатие для томов.

## <a name="create-a-three-way-mirror-volume"></a>Создание трехстороннего зеркального отображения

Чтобы создать трехстороннее зеркальное отображение с помощью Windows Admin Center, выполните следующее.

1. В Windows Admin Center подключитесь к кластеру Локальных дисковых пространств и выберите элемент **Тома** на панели **Инструменты**.
2. На странице **Тома** выберите вкладку **Учет** и щелкните **Создать том**.
3. На панели **Создание тома** введите имя для нового тома и сохраните для параметра **Устойчивость** значение **Трехстороннее зеркало**.
4. В поле **Размер HDD** укажите размер тома. Например, 5 ТБ (терабайт).
5. Нажмите кнопку **создания**.

В зависимости от размера создание тома может занять несколько минут. Оповещения в верхнем правом углу сообщат вам, когда создание тома будет завершено Новый том появится в списке ресурсов.

Посмотрите краткое видео о создании тома с трехсторонним зеркальным отображением.

> [!VIDEO https://www.youtube-nocookie.com/embed/o66etKq70N8]

## <a name="create-a-mirror-accelerated-parity-volume"></a>Создание тома с контролем четности с зеркальным ускорением

Контроль четности с зеркальным ускорением снижает объем, занимаемый томом на диске HDD. Например, том с трехсторонним зеркальным отображением требует 30 терабайт занимаемой памяти на диске для каждых 10 терабайт своего размера. Чтобы снизить объем занимаемой памяти в хранилище, создайте том с контролем четности с зеркальным ускорением. Помещая в зеркальный сегмент только 20 % наиболее активно используемых данных и применяя для остального объема контроль четности, который более эффективно использует пространство, вы снизите занимаемый объем памяти с 30 до 22 терабайт, даже если в системе всего 4 сервера. Вы можете корректировать соотношение между сегментами с зеркальным отображением и контролем четности, балансируя производительность и емкость с учетом потребностей конкретной рабочей нагрузки. Например, 90 процентов с контролем четности и 10 процентов с зеркальным отображением несколько снизят производительность, но сэкономят дополнительное пространство в хранилище.

Чтобы создать том с контролем четности с зеркальным ускорением в Windows Admin Center, выполните следующее.

1. В Windows Admin Center подключитесь к кластеру Локальных дисковых пространств и выберите элемент **Тома** на панели **Инструменты**.
2. На странице "Тома" выберите вкладку **Учет** и щелкните **Создать том**.
3. На панели **Создание тома** введите имя для нового тома.
4. Для параметра **Устойчивость** выберите **Mirror-accelerated parity** (Контроль четности с зеркальным ускорением).
5. В поле **Parity percentage** (Процентная доля контроля четности) введите желаемое значение.
6. Нажмите кнопку **создания**.

Посмотрите краткое видео о создании тома с контролем четности с зеркальным ускорением.

> [!VIDEO https://www.youtube-nocookie.com/embed/R72QHudqWpE]

## <a name="open-volume-and-add-files"></a>Открытие тома и добавление файлов

Чтобы открыть том и добавить в него файлы с помощью Windows Admin Center, выполните следующие действия.

1. В Windows Admin Center подключитесь к кластеру Локальных дисковых пространств и выберите элемент **Тома** на панели **Инструменты**.
2. На странице **Тома** выберите вкладку **Учет**.
2. Из списка томов выберите имя тома, который нужно открыть.

    На странице сведений о томе будет указан путь к этому тому.

4. В верхней части страницы щелкните **Открыть**. Это действие запускает средство **Файлы** из Windows Admin Center.
5. Перейдите к папке, которую обозначает путь к тому. Здесь вы можете просмотреть файлы в томе.
6. Щелкните **Отправка**, а затем выберите нужный файл для отправки.
7. С помощью кнопки **Назад** в браузере вернитесь на панель **Инструменты** в Windows Admin Center.

Посмотрите краткое видео о том, как открыть том и добавить файлы.

> [!VIDEO https://www.youtube-nocookie.com/embed/j59z7ulohs4]

## <a name="turn-on-deduplication-and-compression"></a>Включение дедупликации и сжатия.

Дедупликация и сжатие настраиваются отдельно для каждого тома. Дедупликация и сжатие используют модель постобработки, то есть вы не заметите никаких улучшений, пока она не будет запущена. После этого будут обработаны все файлы, даже присутствовавшие на диске ранее.

1. В Windows Admin Center подключитесь к кластеру Локальных дисковых пространств и выберите элемент **Тома** на панели **Инструменты**.
2. На странице **Тома** выберите вкладку **Учет**.
3. Из списка томов выберите имя тома, которым вы намерены управлять.
4. На странице сведений о томе щелкните переключатель **Дедупликация и сжатие**.
5. На панели **Включение дедупликации** выберите режим дедупликации.

    Вместо сложных отдельных настроек Windows Admin Center предоставляет на выбор готовые профили для разных типов рабочих нагрузок. Используйте значения по умолчанию, если вы не уверены в выборе.

6. Нажмите кнопку **Включить**.

Просмотрите краткое видео о том, как включить дедупликацию и сжатие.

> [!VIDEO https://www.youtube-nocookie.com/embed/PRibTacyKko]

## <a name="create-volumes-using-windows-powershell"></a>Создание томов с использованием Windows PowerShell

Для начала запустите Windows PowerShell из меню Пуск. Для создания томов в Azure Stack HCI мы рекомендуем использовать командлет **New-Volume**. Он предоставляет самый быстрый и понятный процесс. Один этот командлет автоматически создаст виртуальный диск и разделы на нем, отформатирует его и создаст том с таким же именем, а затем добавит общие тома в кластер. Все это один несложный процесс.

Командлет **New-Volume** принимает четыре параметра, которые вам нужно ему предоставить.

- **FriendlyName:** любая строка на ваше усмотрение, например *"Volume1"* .
- **FileSystem:** введите вариант **CSVFS_ReFS** (рекомендуется) или **CSVFS_NTFS**.
- **StoragePoolFriendlyName:** имя пула носителей, например *"S2D on ClusterName"* .
- **Size:** размер тома, например *"10TB"* .

   > [!NOTE]
   > Windows, в том числе PowerShell, считают размер в двоичных значениях (base-2), а размер на самих дисках обычно маркируется в десятичных значениях (base-10). Это объясняет, почему "терабайтный" диск, который определяется производителем как диск объемом 1 000 000 000 000 байт, отображается в Windows как "909 ГБ". Это ожидаемое поведение. Создавая том с помощью **New-Volume**, нужно указывать значение для параметра **Size** в двоичных числах (base-2). Например, значение "909GB" или "0.909495TB" создаст том с объемом примерно 1 000 000 000 000 байт.

### <a name="example-with-2-or-3-servers"></a>Пример Для двух или трех серверов

Чтобы упростить процесс, для развертывания с двумя серверами Локальные дисковые пространства автоматически создают двустороннее зеркальное отображение для обеспечения устойчивости. Если в развертывании три сервера, автоматически создается трехстороннее зеркальное отображение.

```PowerShell
New-Volume -FriendlyName "Volume1" -FileSystem CSVFS_ReFS -StoragePoolFriendlyName S2D* -Size 1TB
```

### <a name="example-with-4-servers"></a>Пример Для четырех и более серверов

Если у вас четыре сервера или больше, можно применить необязательный параметр **ResiliencySettingName** для выбора типа устойчивости.

-   **ResiliencySettingName:** укажите **Mirror** (Зеркало) или **Parity** (Четность).

В следующем примере для *"Volume2"* применяется трехстороннее зеркальное отображение, а для *"Volume3"*  — двойной контроль четности (также именуется как "удаляющее кодирование").

```PowerShell
New-Volume -FriendlyName "Volume2" -FileSystem CSVFS_ReFS -StoragePoolFriendlyName S2D* -Size 1TB -ResiliencySettingName Mirror
New-Volume -FriendlyName "Volume3" -FileSystem CSVFS_ReFS -StoragePoolFriendlyName S2D* -Size 1TB -ResiliencySettingName Parity
```

### <a name="example-using-storage-tiers"></a>Пример Использование уровней хранилища

В развертываниях с тремя типами дисков каждый том может размещаться частично на уровне дисков SSD, а частично на жестких дисках HDD. Аналогично, в развертываниях с четырьмя и более серверами каждый том может сочетать зеркальное отображение и двойной контроль четности, распределяясь между ними.

Чтобы помочь вам в создании томов, Локальные дисковые пространства предоставляют стандартные шаблоны уровней с названиями *Performance* (Производительность) и *Capacity* (Емкость). Они содержат определения для трехстороннего зеркального отображения для более быстрых дисков емкости (если применимо) и двойного контроля четности для более медленных дисков емкости (если применимо).

Вы можете наблюдать их действие, выполнив командлет **Get-StorageTier**.

```PowerShell
Get-StorageTier | Select FriendlyName, ResiliencySettingName, PhysicalDiskRedundancy
```

![Снимок экрана PowerShell для уровней хранилища](media/creating-volumes/storage-tiers-screenshot.png)

Чтобы создать тома на нескольких уровнях, укажите ссылки на эти шаблоны уровней с помощью параметров **StorageTierFriendlyNames** и **StorageTierSizes** командлета **New-Volume**. Например, следующий командлет создает один том, в котором трехстороннее зеркальное отображение и двойной контроль четности сочетаются в соотношении 30:70.

```PowerShell
New-Volume -FriendlyName "Volume4" -FileSystem CSVFS_ReFS -StoragePoolFriendlyName S2D* -StorageTierFriendlyNames Performance, Capacity -StorageTierSizes 300GB, 700GB
```

Готово! Повторите процесс, если вам нужно создать больше одного тома.

## <a name="next-steps"></a>Дальнейшие действия

Чтобы выполнить в Локальных дисковых пространствах другие задачи управления хранилищем, воспользуйтесь руководствами:

- [Обзор Локальных дисковых пространств](/windows-server/storage/storage-spaces/storage-spaces-direct-overview)
- [Планирование томов в Локальных дисковых пространствах](/windows-server/storage/storage-spaces/plan-volumes)
- [Расширение томов в Локальных дисковых пространствах](/windows-server/storage/storage-spaces/resize-volumes)
- [Удаление томов в Локальных дисковых пространствах](/windows-server/storage/storage-spaces/delete-volumes)