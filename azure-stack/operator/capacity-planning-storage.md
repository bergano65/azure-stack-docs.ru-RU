---
title: Планирование емкости хранилища для Azure Stack | Документы Майкрософт
description: Сведения о планировании емкости хранилища для развертываний Azure Stack.
services: azure-stack
documentationcenter: ''
author: mattbriggs
manager: femila
editor: ''
ms.assetid: ''
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/20/2019
ms.author: mabrigg
ms.reviewer: prchint
ms.lastreviewed: 02/20/2019
ms.openlocfilehash: 549428b7a47065dfcb0bdb55ff100332b066f4bc
ms.sourcegitcommit: 2a4321a9cf7bef2955610230f7e057e0163de779
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/14/2019
ms.locfileid: "65618898"
---
# <a name="azure-stack-storage-capacity-planning"></a>Планирование емкости хранилища для Azure Stack
В следующих разделах приводятся сведения о планировании емкости хранилища для Azure Stack, которые помогут спланировать потребности решения в ресурсах хранения.

## <a name="uses-and-organization-of-storage-capacity"></a>Использование и организация емкости хранилища
Гиперконвергентная конфигурация Azure Stack позволяет совместно использовать физические устройства хранения. Доступные ресурсы хранения делятся в первую очередь между инфраструктурой, временным хранилищем для виртуальных машин клиента и хранилищем, используемым службами Azure Consistent Storage (ACS) для больших двоичных объектов, таблиц и очередей.

## <a name="spaces-direct-cache-and-capacity-tiers"></a>Кэш и уровни емкости локальных дисковых пространств
Часть емкости хранилища используется для операционной системы, локальных журналов, дампов и других временных потребностей инфраструктуры. Это локальное хранилище (устройства и ресурсы) отделено от устройств хранения, находящихся под управлением конфигурации локальных дисковых пространств. Остальные устройства хранения помещаются в единый пул хранения вне зависимости от числа серверов в единице масштабирования. Эти устройства бывают двух типов: кэши и емкость.  Устройства кэша, как ясно из названия, служат для организации кэша. Локальные дисковые пространства используют их для кэширования операций обратной записи и чтения. Емкость устройств хранения не включается в видимую емкость отформатированных виртуальных дисков. Устройства емкости служат основным местом размещения для данных, управляемых локальными дисковыми пространствами.

Вся емкость хранилища выделяется и управляется непосредственно инфраструктурой Azure Stack. Оператору не нужно принимать решения касательно конфигурации, выделения или увеличения емкости. Эти проектные решения принимаются автоматически в соответствии с требованиями решения во время начальной установи или развертывания либо при увеличении емкости. Особенности, касающиеся устойчивости, резервной емкости для повторных сборок, а также другие факторы были учтены при разработке. 

Оператор может выбрать хранилище на основе исключительно флэш-памяти или гибридную конфигурацию хранилища:

![Планирование емкости хранилища Azure](media/azure-stack-capacity-planning/storage.png)

Все конфигурации флэш-памяти делятся на одно- или двухуровневые.  Если конфигурация является одноуровневой, вся пропускная способность устройства будет иметь один тип (например, NVMe или SATA SSD или SAS SSD), а кэш устройства использоваться не будет. В двухуровневой конфигурации флэш-памяти NVMe является типичной конфигурацией в качестве устройств кэширования, а затем SATA или SAS SSD в качестве пропускной способности устройств.

В гибридной двухуровневой конфигурации для кэша можно выбрать NVMe, SATA или SSD SATA, а емкость основана на жестких дисках (HDD). 

Ниже приведен краткий обзор локальных дисковых пространств и конфигурации хранилища Azure Stack.
- Один пул дисковых пространств на единицу масштабирования (все устройства хранения настраиваются в одном пуле).
- Виртуальные диски создаются в виде трех зеркальных копий для оптимальной производительности и устойчивости.
- Каждый виртуальный диск отформатирован в файловой системе ReFS.
- Емкость виртуальных дисков рассчитывается и выделяется так, чтобы емкость, соответствующая одному устройству емкости, оставалась в пуле невыделенной. Это равносильно одному диску емкости на сервер.
- В каждой файловой системе ReFS включена функция BitLocker для шифрования неактивных данных. 

Виртуальные диски создаются автоматически и имеют следующую емкость:

|ИМЯ|Расчет емкости|ОПИСАНИЕ|
|-----|-----|-----|
|Локальное или загрузочное устройство|Не менее 340 ГБ <sup>1</sup>|Хранилище на отдельных серверах для образов операционной системы и локальных виртуальных машин инфраструктуры|
|Инфраструктура|3,5 ТБ|Общее использование инфраструктуры Azure Stack|
|VmTemp|См. ниже <sup>2</sup>|К виртуальным машинам клиента подключены временные диски, на которых хранятся эти данные|
|ACS|См. ниже <sup>3</sup>|Емкость Azure Consistent Storage для служб больших двоичных объектов, таблиц и очередей|

<sup>1</sup> Минимальная емкость хранилища, которая требуется от партнера по решению Azure Stack.

<sup>2</sup> Размер виртуального диска, используемого для временных дисков виртуальных машин клиента, рассчитывается как доля физической памяти сервера. Как указано в приведенных ниже таблицах для размеров виртуальных машин IaaS Azure, размер временного диска представляет собой долю физической памяти, назначенной виртуальной машине. Выделение ресурсов хранения для временного диска в Azure Stack осуществляется так, чтобы охватить большинство сценариев использования, но при этом могут не удовлетворять все потребности в хранении для временного диска. При выборе этой доли ставилась задача обеспечить доступность временного хранилища, но в то же время не допустить отведения большей части емкости, имеющейся в решении, под временный диск. Для каждого сервера в единице масштабирования создается один временный диск. Емкость временного хранилища не может превышать 10 % от общей доступной емкости хранилища в пуле носителей единицы масштабирования. Расчет производится примерно так:

```
  DesiredTempStoragePerServer = PhysicalMemory * 0.65 * 8
  TempStoragePerSolution = DesiredTempStoragePerServer * NumberOfServers
  PercentOfTotalCapacity = TempStoragePerSolution / TotalAvailableCapacity
  If (PercentOfTotalCapacity <= 0.1)
      TempVirtualDiskSize = DesiredTempStoragePerServer
  Else
      TempVirtualDiskSize = (TotalAvailableCapacity * 0.1) / NumberOfServers
```

<sup>3</sup> Размер виртуальных дисков, создаваемых для использования службами ACS, получается в результате деления оставшейся емкости без остатка. Как отмечалось, все виртуальные диски представляют собой три зеркальные копии, и для каждого сервера остается невыделенной емкость, соответствующая одному диску емкости. Сначала выделяются различные виртуальные диски, перечисленные выше, а оставшаяся емкость используется для виртуальных дисков ACS.

## <a name="next-steps"></a>Дополнительная информация
[Таблица планирования емкости для Azure Stack](capacity-planning-spreadsheet.md)
