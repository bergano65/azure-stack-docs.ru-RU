---
title: Подготовка пакета обновления Azure Stack | Документация Майкрософт
description: Узнайте, как подготовить пакет обновления Azure Stack.
services: azure-stack
documentationcenter: ''
author: mattbriggs
manager: femila
editor: ''
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/15/2019
ms.author: mabrigg
ms.lastreviewed: 08/15/2019
ms.reviewer: ppacent
ms.openlocfilehash: ab7b764e608ed1fb8008071296d0004f6ef65e7a
ms.sourcegitcommit: 1c45814696e70ba987dd39ce61d93ea4ef5222ea
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2019
ms.locfileid: "70029479"
---
# <a name="prepare-an-azure-stack-update-package"></a>Подготовка пакета обновления Azure Stack

*Область применения: интегрированные системы Azure Stack*

В этой статье приводятся общие сведения о подготовке пакетов обновления Azure Stack, чтобы их можно было использовать для обновления среды Azure Stack. Эта процедура состоит из следующих шагов:

- [Скачивание пакета обновления](https://docs.microsoft.com/azure-stack/operator/azure-stack-update-prepare-package#download-the-update-package).
- [Импорт пакета обновления в среду Azure Stack через портал администрирования Azure Stack](https://docs.microsoft.com/azure-stack/operator/azure-stack-update-prepare-package#import-and-install-updates).

Этот процесс выполняется автоматически для установки обновлений программного обеспечения и исправлений для Azure Stack в системах с подключением к Интернету и доступом к [конечным точкам автоматического обновления Azure Stack](https://docs.microsoft.com/azure-stack/operator/azure-stack-update-prepare-package#automatic-download-and-preparation-for-update-packages).

В таблице ниже показано, когда пакеты обновления требуется подготовить вручную и когда они подготавливаются автоматически.

| Тип обновления | Подключение среды Azure Stack к [конечным точкам автоматического обновления Azure Stack](https://docs.microsoft.com/azure-stack/operator/azure-stack-update-prepare-package#automatic-download-and-preparation-for-update-packages) | Требуется действие |
| --- | --- | --- |
| Обновления программного обеспечения Azure Stack | Подключено | Обновление автоматически скачивается и подготавливается при его применении. |
| Исправления для Azure Stack | Подключено | Обновление автоматически скачивается и подготавливается при его применении. |
| Обновления пакета от изготовителя оборудования | Подключено | Пакет обновления нужно подготовить. Выполните шаги, приведенные в этой статье. |
| Обновления программного обеспечения Azure Stack | Отсутствующее или ненадежное подключение | Пакет обновления нужно подготовить. Выполните шаги, приведенные в этой статье. |
| Исправления для Azure Stack | Отсутствующее или ненадежное подключение | Пакет обновления нужно подготовить. Выполните шаги, приведенные в этой статье. |
| Обновления пакета от изготовителя оборудования | Отсутствующее или ненадежное подключение | Пакет обновления нужно подготовить. Выполните шаги, приведенные в этой статье. |

## <a name="download-the-update-package"></a>Скачивание пакета обновлений
Пакет обновления с обновлениями и исправлениями для Azure Stack доступен в колонке "Обновление" для подключенных систем. Необходимо скачать этот пакет и переместить его в расположение, доступное экземпляру Azure Stack, если выполняется установка обновления пакета от изготовителя оборудования или если обслуживается отключенная система (без подключения к Интернету). Может также потребоваться скачать и передать пакет в доступное расположение, если используется система с прерывистым подключением.

Проверьте содержимое пакета. Обычно пакет обновлений содержит следующие файлы:

-   **Самораспаковывающийся ZIP-файл \<имя_пакета>.exe**. Этот файл содержит полезные данные обновления.
- **Файл Metadata.xml**. Этот файл содержит важные сведения об обновлении, например название издателя, имя пакета, необходимые компоненты, размер и URL-адрес для поддержки.

### <a name="automatic-download-and-preparation-for-update-packages"></a>Автоматическое скачивание и подготовка пакетов обновления
Обновления программного обеспечения и исправления для Azure Stack подготавливаются автоматически для систем с подключением к **конечным точкам автоматического обновления Azure Stack**: https://*.azureedge.net и https://aka.ms/azurestackautomaticupdate. Дополнительные сведения о настройке подключения к **конечным точкам автоматического обновления Azure Stack** см. в разделе о конечных точках **исправлений и обновлений** в статье [Интеграция центра обработки данных Azure Stack. Публикация служб Azure Stack](https://docs.microsoft.com/azure-stack/operator/azure-stack-integrate-endpoints#ports-and-urls-outbound).

### <a name="where-to-download-azure-stack-update-packages"></a>Откуда скачивать пакеты обновления Azure Stack

Файлы [полных и экспресс-обновлений](https://docs.microsoft.com/azure-stack/operator/azure-stack-updates#update-package-types) для Azure Stack размещаются на защищенной конечной точке Azure. Операторы Azure Stack с подключенными экземплярами увидят, как [обновления для Azure Stack будут автоматически появляться на портале администрирования](https://docs.microsoft.com/azure-stack/operator/azure-stack-update-prepare-package#automatic-download-and-preparation-for-update-packages). Для отключенных от Интернета систем или систем с ненадежным подключением к Интернету пакеты обновления [можно скачать с помощью загрузчика обновлений для Azure Stack](https://aka.ms/azurestackupdatedownload). Пакеты обновления программного обеспечения Azure Stack могут содержать обновления служб Azure Stack, а также обновления операционной системы единиц масштабирования Azure Stack.

### <a name="where-to-download-azure-stack-hotfix-packages"></a>Откуда скачивать исправления Azure Stack

Пакет с [исправлениями для Azure Stack](https://docs.microsoft.com/azure-stack/operator/azure-stack-updates#update-package-types) размещается на той же защищенной конечной точке Azure, на которой хранятся обновления для Azure Stack. Операторы Azure Stack с подключенными экземплярами увидят, как [обновления для Azure Stack будут автоматически появляться на портале администрирования](https://docs.microsoft.com/azure-stack/operator/azure-stack-update-prepare-package#automatic-download-and-preparation-for-update-packages). Вы можете скачать их, используя встроенные ссылки в каждой соответствующей статье базы знаний об исправлении, например [Исправление Azure Stack 1.1906.11.52](https://support.microsoft.com/help/4515650). Исправления можно найти в заметках о выпуске, соответствующих версии Azure Stack. Обновления, предоставленные поставщиком оборудования от изготовителя оборудования

### <a name="where-to-download-oem-update-packages"></a>Откуда скачивать пакеты обновления от изготовителя оборудования
Поставщиком изготовителя оборудования также будут выпускаться обновления, например обновления драйверов и встроенного ПО. Хотя эти обновления предоставляются поставщиком оборудования как отдельные [пакеты обновления от изготовителя оборудования](https://docs.microsoft.com/azure-stack/operator/azure-stack-updates#update-package-types), их импорт, установка и управление ими аналогичны соответствующим процедурам для пакетов обновления от корпорации Майкрософт. Список контактных данных поставщиков можно найти в разделе [Применение обновлений изготовителя оборудования для Azure Stack](https://docs.microsoft.com/azure-stack/operator/azure-stack-update-oem#oem-contact-information).

## <a name="import-and-install-updates"></a>Импорт и установка обновлений

Ниже описано, как импортировать и устанавливать пакеты обновления на портале администратора.

> [!Important]  
> Уведомьте пользователей о любых операциях технического обслуживания и планировать стандартные окна обслуживания по возможности в нерабочее время. Операции технического обслуживания могут влиять на рабочие нагрузки пользователей и на операции портала.

1.  На портале администратора щелкните **Все службы**. После этого в категории **Данные+хранилище** выберите **Учетные записи хранения**. (Или начните вводить текст **учетные записи хранения** в поле ввода и выберите найденный элемент.)

    ![Обновление Azure Stack](./media/azure-stack-update-prepare-package/image1.png) 

1.  В поле фильтра введите текст **update** и выберите учетную запись хранения **updateadminaccount**.

2.  В разделе **Службы** сведений об учетной записи хранения выберите **BLOB-объекты**.

    ![Обновление Azure Stack: большой двоичный объект](./media/azure-stack-update-prepare-package/image2.png)

1.  В разделе **Служба BLOB-объектов** выберите **+ Контейнер**, чтобы создать контейнер. Введите имя (например, *update-1811*) и щелкните **ОК**.

    ![Обновление Azure Stack: контейнер](./media/azure-stack-update-prepare-package/image3.png)

1.  После создания контейнера щелкните его имя и нажмите кнопку **Отправить**, чтобы отправить в контейнер файлы пакета.

    ![Обновление Azure Stack: передача](./media/azure-stack-update-prepare-package/image4.png)

1.  В разделе **Отправка большого двоичного объекта** щелкните значок папки, найдите ZIP-файл пакета обновления и щелкните **Открыть** в окне обозревателя файлов.

2.  В разделе **Отправка большого двоичного объекта** щелкните **Отправить**.

    ![Обновление Azure Stack: передача большого двоичного объекта](./media/azure-stack-update-prepare-package/image5.png)

1.  Повторите шаги 6 и 7 для файла Metadata.xml и всех дополнительных ZIP-файлов в пакете обновления. Не импортируйте файл Supplemental Notice.txt, если он включен.

2.  Когда все будет готово, просмотрите уведомления (значок колокольчика в правом верхнем углу окна портала). В списке уведомлений должно быть сообщение о завершении отправки.

3.  Вернитесь к колонке "Обновление" на панели мониторинга. Теперь в этой колонке должно отображаться доступное обновление. Это означает, что обновление успешно подготовлено. Щелкните колонку, чтобы просмотреть только что добавленный пакет обновления.

4.  Чтобы установить обновления, выберите пакет с пометкой **Ready** (Готов), а затем щелкните его правой кнопкой мыши и выберите действие **Update now** (Обновить сейчас) или нажмите кнопку **Update now** (Обновить сейчас) в верхней части экрана.

5.  Щелкнув пакет обновления, вы можете просмотреть его состояние в области **Update run details** (Сведения о выполнении обновления). Здесь вы можете также щелкнуть **Скачивание сводки**, чтобы скачать файлы журнала. Журналы установки обновлений доступны в течение 6 месяцев после завершения попытки.

6.  Когда обновление завершится, в колонке "Обновление" отобразится номер обновленной версии Azure Stack.

Вы можете вручную удалить пакеты обновлений из учетной записи хранения после их установки в Azure Stack. Azure Stack периодически проверяет наличие устаревших пакетов обновлений и удаляет их из хранилища. Azure Stack может понадобится две недели, чтобы удалить устаревшие пакеты.

## <a name="next-steps"></a>Дополнительная информация

[Применение обновления](azure-stack-apply-updates.md)
