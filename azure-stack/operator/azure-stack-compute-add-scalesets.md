---
title: Обеспечение доступности масштабируемых наборов виртуальных машин в Azure Stack | Документация Майкрософт
description: Сведения о том, как оператор облака может добавить масштабируемый набор виртуальных машин в Azure Stack Marketplace
services: azure-stack
author: sethmanheim
manager: femila
editor: ''
ms.service: azure-stack
ms.topic: article
ms.date: 06/04/2019
ms.author: sethm
ms.reviewer: kivenkat
ms.lastreviewed: 10/22/2018
ms.openlocfilehash: 98aae8378e4bd516181cae95b153e6ee445ce4bf
ms.sourcegitcommit: 7f39bdc83717c27de54fe67eb23eb55dbab258a9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/05/2019
ms.locfileid: "66692006"
---
# <a name="make-virtual-machine-scale-sets-available-in-azure-stack"></a>Обеспечение доступности масштабируемых наборов виртуальных машин в Azure Stack

*Область применения: интегрированные системы Azure Stack и Пакет средств разработки Azure Stack*
  
Масштабируемые наборы виртуальных машин представляют собой вычислительный ресурс Azure Stack. С их помощью можно развернуть набор идентичных виртуальных машин и управлять им. При одинаковой настройке всех виртуальных машин масштабируемые наборы не требуют их предварительной подготовки. Это упрощает создание крупномасштабных служб, предназначенных для больших вычислений, больших данных и контейнерных рабочих нагрузок.

В этой статье описано, как обеспечить доступность масштабируемых наборов в Azure Stack Marketplace. После завершения этой процедуры пользователи смогут добавлять масштабируемые наборы виртуальных машин в свои подписки.

Масштабируемые наборы виртуальных машин в Azure Stack подобны масштабируемым наборам виртуальных машин в Azure. Дополнительные сведения см. в следующих видеороликах.

* [Марк Руссинович (Mark Russinovich) рассказывает о масштабируемых наборах Azure.](https://channel9.msdn.com/Blogs/Regular-IT-Guy/Mark-Russinovich-Talks-Azure-Scale-Sets/)
* [Масштабируемые наборы виртуальных машин с Гаем Бауэрманом (Guy Bowerman).](https://channel9.msdn.com/Shows/Cloud+Cover/Episode-191-Virtual-Machine-Scale-Sets-with-Guy-Bowerman)

В Azure Stack масштабируемые наборы виртуальных машин не поддерживают автоматическое масштабирование. В масштабируемый набор можно добавить дополнительные экземпляры с помощью портала, шаблонов Resource Manager или PowerShell.

## <a name="prerequisites"></a>Предварительные требования

* **Marketplace**. Зарегистрируйте Azure Stack в глобальной среде Azure, чтобы элементы стали доступны в Marketplace. См. инструкции по [регистрации Azure Stack в Azure](azure-stack-registration.md).
* **Образ операционной системы**. Прежде чем создавать масштабируемый набор виртуальных машин, скачайте из [Azure Stack Marketplace](azure-stack-download-azure-marketplace-item.md) образы виртуальных машин для использования в масштабируемом наборе. Образы уже должны присутствовать, прежде чем пользователь сможет создать новый масштабируемый набор.

## <a name="use-the-azure-stack-portal"></a>Использование портала Azure Stack

>[!IMPORTANT]  
> Сведения этого раздела применяются при использовании Azure Stack версии 1808 или более поздней версии. Если ваша версия — 1807 или более ранняя версия, см. в разделе [Добавление масштабируемого набора виртуальных машин (до 1808)](#add-the-virtual-machine-scale-set-prior-to-version-1808).

1. Войдите на портал Azure Stack. Выберите **Все службы**, **Масштабируемые наборы виртуальных машин** и затем в разделе **Вычисления** выберите **Масштабируемые наборы виртуальных машин**.
   ![Выбор наборов для масштабирования виртуальных машин](media/azure-stack-compute-add-scalesets/all-services.png)

2. Выберите ***Создать масштабируемые наборы виртуальных машин***.
   ![Создание масштабируемого набора виртуальных машин](media/azure-stack-compute-add-scalesets/create-scale-set.png)

3. Заполните пустые поля, выберите из раскрывающихся списков **Образ диска операционной системы**, **Подписка**, и **Размер экземпляра**. Выберите **Да** для **Использование управляемых дисков**. Затем щелкните **Создать**.
    ![Настройка и создание](media/azure-stack-compute-add-scalesets/create.png)

4. Чтобы просмотреть новый масштабируемый набор виртуальных машин, щелкните **Все ресурсы**, а затем найдите и щелкните в результатах поиска имя виртуальной машины.
   ![Свертывание масштабируемого набора](media/azure-stack-compute-add-scalesets/search.png)

## <a name="add-the-virtual-machine-scale-set-prior-to-version-1808"></a>Добавление масштабируемого набора виртуальных машин (до версии 1808)

>[!IMPORTANT]  
> Сведения этого раздела применяются при использовании Azure Stack более ранних версий. чем 1808. Если вы используете версию 1808 или более позднюю, см. раздел [Добавление масштабируемого набора виртуальных машин](#use-the-azure-stack-portal).

1. Откройте Azure Stack Marketplace и подключитесь к Azure. Выберите **Управление Marketplace** и **+Добавить из Azure**.

    ![Управление Marketplace](media/azure-stack-compute-add-scalesets/image01.png)

2. Добавьте и скачайте элемент Marketplace масштабируемого набора виртуальных машин.

    ![Масштабируемый набор виртуальных машин](media/azure-stack-compute-add-scalesets/image02.png)

## <a name="update-images-in-a-virtual-machine-scale-set"></a>Обновление образов в масштабируемом наборе виртуальных машин

После создания масштабируемого набора виртуальных машин пользователи смогут обновлять образы в этом наборе, не создавая набор масштабирования заново. Процесс обновления образа будет разным в следующих сценариях.

1. В шаблоне развертывания для масштабируемого набора виртуальных машин указано значение **latest** для параметра **version**.  

   Если параметр `version` в разделе шаблона `imageReference` для масштабируемого набора имеет значение **latest**, при увеличении масштаба в масштабируемом наборе всегда будет применяться последняя из доступных версий. Кода увеличение масштаба в наборе завершится, вы можете удалить старые экземпляры из масштабируемого набора виртуальных машин. Значения параметров `publisher`, `offer` и `sku` сохраняются неизменными.

   В следующем примере JSON показано `latest`:  

    ```json  
    "imageReference": {
        "publisher": "[parameters('osImagePublisher')]",
        "offer": "[parameters('osImageOffer')]",
        "sku": "[parameters('osImageSku')]",
        "version": "latest"
        }
    ```

   Чтобы новый образ применялся при увеличении масштаба, его нужно скачать.  

   * Если в Marketplace доступен образ более поздней версии, чем тот, который используется в масштабируемом наборе, скачайте новый образ, чтобы заменить старый. После замены образа пользователь может продолжить увеличение масштаба.

   * Если версия образа в Marketplace совпадает с той, которая используется в масштабируемом наборе, удалите старый образ и скачайте новый. В период между удалением исходного образа и завершением скачивания нового операции увеличения масштаба недоступны.

   Такой процесс применяется для повторного объединения образов в формате разреженного файла, который появился в версии 1803.

2. В шаблоне масштабируемого набора виртуальных машин для параметра **version** указано не значение **latest**, а конкретный номер версии.  

    Если вы скачаете образ более поздней версии (с изменением номера доступной версии), увеличение масштаба для этого масштабируемого набора становится невозможным. Это сделано намеренно, так как указанная в шаблоне версия образа должна быть всегда доступна.  

Дополнительные сведения см. в разделе [Диски и образы операционной системы](../user/azure-stack-compute-overview.md#operating-system-disks-and-images).  

## <a name="scale-a-virtual-machine-scale-set"></a>Масштабирование масштабируемого набора виртуальных машин

Вы можете масштабировать масштабируемого набора виртуальных машин, изменяя его размер.

1. На портале выберите ваш масштабируемый набор, а затем выберите **Масштабирование**.

2. С помощью ползунка установите новый уровень масштабирования для этого масштабируемого набора виртуальных машин, а затем щелкните **Сохранить**.

     ![Масштабирование набора](media/azure-stack-compute-add-scalesets/scale.png)

## <a name="remove-a-virtual-machine-scale-set"></a>Удаление масштабируемого набора виртуальных машин

Чтобы удалить из коллекции элемент масштабируемого набора виртуальных машин, выполните следующую команду PowerShell:

```powershell  
Remove-AzsGalleryItem
```

> [!NOTE]
> Возможно, элемент коллекции не будет удален сразу же. Возможно, вам потребуется обновить портал несколько раз, прежде чем элемент будет отображаться как удаленный из Marketplace.

## <a name="next-steps"></a>Дополнительная информация

* [Скачивание элементов Marketplace из Azure в Azure Stack](azure-stack-download-azure-marketplace-item.md)
