---
title: Планирование интеграции сети для Azure Stack | Документация Майкрософт
description: Из этой статьи вы узнаете, как проектировать интеграцию сети центра обработки данных с интегрированными системами Azure Stack.
services: azure-stack
documentationcenter: ''
author: mattbriggs
manager: femila
editor: ''
ms.assetid: ''
ms.service: azure-stack
ms.workload: na
pms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/07/2019
ms.author: mabrigg
ms.reviewer: wamota
ms.lastreviewed: 06/04/2019
ms.openlocfilehash: 4894fb7184944095d968d08e2d668912a78119d4
ms.sourcegitcommit: ef7efcde76d1d7875ca1c882afebfd6a27f1c686
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/24/2019
ms.locfileid: "72888034"
---
# <a name="network-integration-planning-for-azure-stack"></a>Планирование интеграции сети для Azure Stack

В этой статье приводятся сведения об инфраструктуре сети Azure Stack, которые помогут решить, как лучше всего интегрировать Azure Stack с существующей сетевой средой. 

> [!NOTE]
> Чтобы разрешить внешние имена DNS из Azure Stack (например, www\.bing.com), необходимо предоставить DNS-серверы для переадресации DNS-запросов. Дополнительные сведения о требованиях к DNS Azure Stack см. в статье [Интеграция центра обработки данных Azure Stack — DNS](azure-stack-integrate-dns.md).

## <a name="physical-network-design"></a>Структура физической сети

Чтобы поддерживать выполнение операций и служб, решению Azure Stack требуется гибкая и высокодоступная физическая инфраструктура. Каналы исходящей связи от коммутаторов ToR к пограничным коммутаторам ограничены носителями SFP+ или SFP28 и скоростями 1 ГБ, 10 ГБ или 25 ГБ. Обратитесь к поставщику оборудования OEM, чтобы получить сведения о доступности. На следующей диаграмме представлена наша рекомендуемая архитектура:

![Рекомендуемая структура сети Azure Stack](media/azure-stack-network/recommended-design.png)


## <a name="logical-networks"></a>Логические сети

Логические сети представляют собой абстракцию базовой инфраструктуры физической сети. Они используются, чтобы упорядочить и упростить назначение сетей для узлов, виртуальных машин и служб. При создании логической сети создаются и сайты сети. Они определяют виртуальные локальные сети, IP-подсети и пары из IP-подсетей и виртуальных локальных сетей, связанные с логической сетью в каждом физическом расположении.

В следующей таблице показаны логические сети и соответствующие диапазоны подсети IPv4, которые необходимо выбрать.

| Логические сети | ОПИСАНИЕ | Размер | 
| -------- | ------------- | ------------ | 
| Общедоступный виртуальный IP-адрес | Всего из этой сети в Azure Stack используется 31 адрес. Восемь общедоступных IP-адресов предназначены для небольшого набора служб Azure Stack, а остальные используются виртуальными машинами клиента. Если вы планируете использовать службу приложений и поставщики ресурсов SQL, потребуется еще 7 адресов. Оставшиеся 15 IP-адресов зарезервированы для будущих служб Azure. | /26 (62 узла) –/22 (1022 узла)<br><br>Рекомендуется —  /24 (254 узла) | 
| Инфраструктура коммутаторов | IP-адреса типа "точка —точка" для целей маршрутизации, выделенные интерфейсы управления коммутаторами и петлевые адреса, назначенные коммутатору. | /26 | 
| Инфраструктура | Используется для обмена данными между внутренними компонентами Azure Stack. | /24 |
| Private | Используется для сети хранения данных и частных виртуальных IP-адресов. | /24 | 
| Контроллер управления основной платой (BMC) | Используется для обмена данными с BMC на физических узлах. | /26 | 
| | | |

## <a name="network-infrastructure"></a>Сетевая инфраструктура

Сетевая инфраструктура для Azure Stack состоит из нескольких логических сетей, которые настроены на коммутаторах. На следующей схеме показаны эти логические сети и их интеграция с коммутаторами верхнего уровня (TOR), контроллером управления основной платой (BMC) и граничным коммутатором (клиентская сеть).

![Логическая схема сети и подключения коммутаторов](media/azure-stack-network/NetworkDiagram.png)

### <a name="bmc-network"></a>Сеть BMC

Эта сеть предназначена для подключения всех контроллеров управления основной платой (также называются BMC или служебными процессорами) к сети управления. Например: iDRAC, iLO, iBMC и т. д. Для взаимодействия с любым узлом BMC используется только одна учетная запись BMC. Узел жизненного цикла оборудования (HLH) (при наличии) размещается в этой сети и может предоставлять предназначенное для изготовителей оборудования программное обеспечение для обслуживания или мониторинга оборудования.

Также в HLH размещена виртуальная машина для развертывания (DVM). DVM используется при развертывании Azure Stack и удаляется по завершении развертывания. Для DVM требуется доступ к Интернету в сценариях развертывания с подключением для тестирования, проверки и доступа к нескольким компонентам. Такие компоненты могут находиться в корпоративной сети и за ее пределами (например, NTP, DNS и Azure). Требования к подключению см. в [разделе о NAT статьи "Интеграция брандмауэра Azure Stack"](azure-stack-firewall.md#network-address-translation).

### <a name="private-network"></a>Частная сеть

Эта сеть типа /24 (254 IP-адреса узлов) является частной в регионе Azure Stack (не распространяется на граничные коммутаторы за пределами региона Azure Stack) и делится на две подсети:

- **Сеть хранилища**. Сеть типа /25 (126 IP-адресов узлов) поддерживает использование локальных дисковых пространств, передачу трафика по протоколу SMB и динамическую миграцию виртуальных машин.
- **Внутренняя виртуальная IP-сеть**. Сеть типа /25, предназначенная только для виртуальных IP-адресов для подсистемы балансировки нагрузки программного обеспечения (SLB).

### <a name="azure-stack-infrastructure-network"></a>Сеть инфраструктуры Azure Stack
Эта сеть типа /24 предназначена для внутренних компонентов Azure Stack, чтобы обеспечить обмен данными между ними. Эта подсеть может быть маршрутизируемой извне решения Azure Stack к вашему центру данных. В этой подсети мы не рекомендуем использовать общедоступные или Интернет-маршрутизируемые IP-адреса. Эту сеть объявлено до границы, но большинство ее IP-адресов защищены Списками управления доступом (ACL). IP-адреса, разрешенные для доступа, находятся в небольшом диапазоне, эквивалентном по размеру сети /27 и службам размещения, таким как [привилегированная конечная точка (PEP)](azure-stack-privileged-endpoint.md) и [Azure Stack Backup](azure-stack-backup-reference.md).

### <a name="public-vip-network"></a>Открытая сеть VIP

Открытая сеть VIP назначается для сетевого контроллера в Azure Stack. Это не логическая сеть на коммутаторах. SLB использует пул адресов и назначает сети типа /32 для рабочих нагрузок клиента. В таблице маршрутизации коммутатора эти IP-адреса сети типа /32 объявляются как маршруты, доступные по протоколу BGP. Эта сеть содержит доступные внешние или открытые IP-адреса. Инфраструктура Azure Stack резервирует первый 31 адрес из этой открытой сети VIP, а остальные адреса используют виртуальные машины клиентов. Размер сети в этой подсети может варьироваться от минимум /26 (64 узла) до максимального значения /22 (1022 узла). Рекомендуется планировать сеть размера /24.

### <a name="switch-infrastructure-network"></a>Сеть инфраструктуры коммутаторов

Это подсеть типа /26, содержащая IP-подсети "точка-точка" типа /30 (2 IP-адреса узлов) с поддержкой маршрутизации, и подсети с замыканием на себя, представляющие выделенные подсети типа /32 для управления коммутаторами в основной сети и идентификатора маршрутизатора BGP. Этот диапазон IP-адресов должен маршрутизироваться за пределами решения Azure Stack до центра обработки данных. Это могут быть частные или общедоступные IP-адреса.

### <a name="switch-management-network"></a>Сеть управления коммутаторами

Эта сеть /29 (6 IP-адресов узлов) выделена для подключения портов управления коммутаторами. Она также предоставляет доступ по внештатному каналу для развертывания, управления и устранения неполадок. Она вычисляется на основе сети инфраструктуры коммутаторов, упомянутой выше.

## <a name="next-steps"></a>Дополнительная информация

Дополнительная информация о планировании сети: [Пограничное подключение](azure-stack-border-connectivity.md).
