---
title: Добавление узлов единицы масштабирования в Azure Stack | Документация Майкрософт
description: Узнайте, как добавить узлы единицы масштабирования к единицам масштабирования в Azure Stack.
services: azure-stack
documentationcenter: ''
author: mattbriggs
manager: femila
editor: ''
ms.assetid: ''
ms.service: azure-stack
ms.workload: na
pms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/02/2019
ms.author: mabrigg
ms.reviewer: thoroet
ms.lastreviewed: 09/17/2018
ms.openlocfilehash: 140f184b2ea6af010879d9c42803c6c0acd35b65
ms.sourcegitcommit: 28c8567f85ea3123122f4a27d1c95e3f5cbd2c25
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/02/2019
ms.locfileid: "71824803"
---
# <a name="add-additional-scale-unit-nodes-in-azure-stack"></a>Добавление дополнительных узлов единиц масштабирования в Azure Stack

Операторы Azure Stack могут увеличить общую емкость существующей единицы масштабирования, добавив дополнительный физический компьютер. Физический компьютер также называется узлом единицы масштабирования. Каждый новый добавляемый узел единицы масштабирования должен быть однородным по типу процессора, памяти, номеру и размеру диска для узлов, которые уже присутствуют в единице масштабирования.

Чтобы добавить узел единицы масштабирования, войдите в Azure Stack и запустите средства от изготовителя оборудования (OEM). Инструментарий OEM работает на узле жизненного цикла оборудования (HLH), чтобы убедиться, что новый физический компьютер соответствует тому же уровню встроенного ПО, что и существующие узлы.

На блок-схеме ниже показан общий процесс добавления узла единицы масштабирования.

![Процесс добавления единицы масштабирования](media/azure-stack-add-scale-node/add-node-flow.png)
<br> *Устанавливает ли поставщик оборудования от изготовителя оборудования размещение стойки физического сервера и обновляет ли встроенное ПО, зависит от вашего контракта на поддержку.*

Операция добавления нового узла может занять несколько часов или дней.

> [!Note]  
> Не выполняйте ни одну из следующих операций, если операция добавления узла единиц масштабирования уже запущена:
>
>  - Обновление Azure Stack
>  - Ротация сертификатов
>  - Остановка Azure Stack
>  - Исправление узла единицы масштабирования


## <a name="add-scale-unit-nodes"></a>Добавление узлов единиц масштабирования

Следующие действия — это общий обзор того, как добавить узел. Не выполняйте приведенные ниже действия, не ознакомившись с документацией изготовителя оборудования об увеличении емкости.

1. Поместите новый физический сервер в стойке и подключите его соответствующим образом. 
2. Включите порты физического коммутатора и настройте списки управления доступом (ACL), если это применимо.
3. Настройте правильный IP-адрес в контроллере управления основной платой (BMC) и примените все настройки BIOS в соответствии с документацией изготовителя оборудования.
4. Примените текущий базовый план встроенного ПО ко всем компонентам, используя инструменты, которые предоставляются производителем оборудования, работающим на HLH.
5. Запустите операцию "Добавить узел" на портале администрирования Azure Stack.
6. Убедитесь, что операция добавления узла успешно завершена. Для этого проверьте [**Состояние** единицы масштабирования](#monitor-add-node-operations). 

## <a name="add-the-node"></a>Добавление узла

Чтобы добавить новые узлы, можно использовать портал администрирования или PowerShell. Операция добавления узла сначала добавляет новый узел единицы масштабирования в качестве доступной вычислительной емкости, а затем автоматически расширяет емкость хранилища. Емкость развертывается автоматически, так как Azure Stack — это гиперконвергентная система, где *вычисление* и *хранение* масштабируются вместе.

### <a name="use-the-administrator-portal"></a>Использование портала администрирования

1. Войдите на портал администратора Azure Stack в качестве оператора Azure Stack.
2. Перейдите к **+ Создать ресурс** > **Емкость** > **Узел единиц масштабирования**.
   ![Узел единиц масштабирования](media/azure-stack-add-scale-node/select-node1.png)
3. На панели **Добавление узла** выберите *Регион*, а затем выберите *Единицы масштабирования*, к которым нужно добавить узел. Также укажите *IP-адресс BMC* для добавляемого узла единицы масштабирования. Можно добавлять только один узел за раз.
   ![Добавление сведений об узле](media/azure-stack-add-scale-node/select-node2.png)
 

### <a name="use-powershell"></a>Использование PowerShell

Чтобы добавить узел, используйте командлет **New-AzsScaleUnitNodeObject**.  

Прежде чем использовать один из следующих сценариев PowerShell, замените значения *Имена узлов* и *IP-адреса* на значения из среды Azure Stack.

  > [!Note]  
  > При присвоении имени узла необходимо придерживаться ограничения на имя, не превышать 15 символов. Также невозможно использовать имя, которое содержит пробелы или содержит какой-либо из следующих знаков: `\`, `/`, `:`, `*`, `?`, `"`, `<`, `>`, `|`, `\`, `~`, `!`, `@`, `#`, `$`, `%`, `^`, `&`, `(`, `)`, `{`,`}`, `_`.

**Добавить заметку:**
  ```powershell
  ## Add a single Node 
  $NewNode=New-AzsScaleUnitNodeObject -computername "<name_of_new_node>" -BMCIPv4Address "<BMCIP_address_of_new_node>" 
 
  Add-AzsScaleUnitNode -NodeList $NewNode -ScaleUnit "<name_of_scale_unit_cluster>" 
  ```  

## <a name="monitor-add-node-operations"></a>Мониторинг операций добавления узла 
Чтобы узнать состояние операции добавления узла, можно использовать портал администрирования или PowerShell. Операции добавления узлов могут длиться от нескольких часов до нескольких дней.

### <a name="use-the-administrator-portal"></a>Использование портала администрирования 
Чтобы отслеживать добавление нового узла, на портале администрирования просмотрите единицу масштабирования или объекты узла единицы масштабирования. Для этого перейдите к **Управление регионами** > **Единицы масштабирования**. Затем выберите единицу масштабирования или узел единицы масштабирования, которую необходимо просмотреть. 

### <a name="use-powershell"></a>Использование PowerShell
Состояние единицы масштабирования и узлов единицы масштабирования можно получить с помощью PowerShell следующим образом.
  ```powershell
  #Retrieve Status for the Scale Unit
  Get-AzsScaleUnit|select name,state
 
  #Retrieve Status for each Scale Unit Node
  Get-AzsScaleUnitNode |Select Name, ScaleUnitNodeStatus
```

### <a name="status-for-the-add-node-operation"></a>Состояние операции добавления узла 
**Для единицы масштабирования.**

|Status               |ОПИСАНИЕ  |
|---------------------|---------|
|Выполнение              |Все узлы активно участвуют в единице масштабирования.|
|Остановлено              |Узел единицы масштабирования не работает или недоступен.|
|Развертывание            |В настоящее время в качестве вычислительной емкости добавляются один или несколько узлов единиц масштабирования.|
|Настройка хранилища  |Вычислительная емкость расширена и конфигурация хранилища запущена.|
|Требуется исправление |Обнаружена ошибка, требующая восстановления одного или нескольких узлов единиц масштабирования.|


**Для узла единицы масштабирования.**

|Status                |ОПИСАНИЕ  |
|----------------------|---------|
|Выполнение               |Узел активно участвует в единице масштабирования.|
|Остановлено               |Узел недоступен.|
|Добавление                |Узел активно добавляется в единицу масштабирования.|
|Восстановление             |Восстановление узла активно выполняется.|
|Обслуживание,           |Узел приостановлен, и нет запущенных активных пользовательских рабочих нагрузок. |
|Требуется исправление  |Обнаружена ошибка, требующая восстановления узла.|


## <a name="troubleshooting"></a>Устранение неполадок
Ниже приведены распространенные проблемы, возникающие при добавлении узла. 

**Сценарий 1.**  Операция добавления узла единицы масштабирования прекращена, но один или несколько узлов имеют состояние "Остановлено".  
- Исправление. Используйте операцию восстановления, чтобы восстановить один или несколько узлов. За один раз можно выполнить только одну операцию восстановления.

**Сценарий 2.** Добавлено один или несколько узлов единиц масштабирования, но возникла ошибка расширения хранилища. В этом сценарии объект узла единицы масштабирования сообщает о состоянии "Выполнение", но задача настройки хранилища не запущена.  
- Исправление. Используйте привилегированную конечную точку для просмотра данных о работоспособности хранилища, выполнив следующий командлет PowerShell.
  ```powershell
     Get-VirtualDisk -CimSession s-cluster | Get-StorageJob
  ```
 
**Сценарий 3.** Пришло оповещение, которое указывает, что задание горизонтального масштабирования хранилища не выполнено.  
- Исправление. В этом случае задача конфигурации хранилища не выполнена. С этой проблемой необходимо обратиться в службу поддержки.


## <a name="next-steps"></a>Дополнительная информация 
[Добавление общедоступных IP-адресов](azure-stack-add-ips.md) 
