---
title: Автономное обновление службы приложений Azure | Документация Майкрософт
description: Подробные инструкции по обновлению Службы приложений Azure в Azure Stack Hub без подключения к Интернету
services: azure-stack
documentationcenter: ''
author: bryanla
manager: femila
editor: ''
ms.assetid: ''
ms.service: azure-stack
ms.workload: app-service
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/13/2020
ms.author: anwestg
ms.reviewer: anwestg
ms.openlocfilehash: d0cfc906030355dac78da3561da2b746a9a0dc92
ms.sourcegitcommit: e47dc5fe9e59010ea3dbb9cb31abe15cfb821262
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/16/2020
ms.locfileid: "76124826"
---
# <a name="offline-update-of-azure-app-service-on-azure-stack-hub"></a>Автономное обновление Службы приложений Azure в Azure Stack Hub

> [!IMPORTANT]
> Прежде чем развертывать Службу приложений Azure 1.8, примените обновление версии 1910 и выше к интегрированной системе Azure Stack Hub или разверните последний пакет средств разработки Azure Stack Hub.

Выполнив инструкции из этой статьи, вы обновите [поставщик ресурсов Службы приложений Azure](azure-stack-app-service-overview.md), развернутый в среде Azure Stack Hub со следующими характеристиками:

* без подключения к Интернету;
* под защитой службы федерации Active Directory (AD FS).

> [!IMPORTANT]
> Прежде чем выполнять обновление, [разверните Службу приложений Azure в поставщике ресурсов Azure Stack Hub](azure-stack-app-service-deploy-offline.md) и просмотрите [заметки](azure-stack-app-service-release-notes-update-eight.md) о выпуске 1.8, чтобы узнать о новых функциях, исправлениях и известных проблемах, которые могут повлиять на развертывание.

## <a name="run-the-app-service-resource-provider-installer"></a>Запуск установщика поставщика ресурсов службы приложений

Чтобы обновить поставщик ресурсов Службы приложений в среде Azure Stack Hub, выполните следующие задачи:

1. Скачайте [установщик Службы приложений Azure](https://aka.ms/appsvcupdate8installer).
2. Создайте автономный пакет обновления.
3. Запустите установщик службы приложений (appservice.exe) и завершите обновление.

В ходе обновления выполняются следующие действия:

* обнаружение предыдущего развертывания службы приложений;
* отправка в службу хранилища;
* обновление всех ролей службы приложений (контроллеры, управление, внешний интерфейс, издатель и рабочие роли);
* обновление определений масштабируемого набора службы приложений;
* обновление манифеста поставщика ресурсов службы приложений.

## <a name="create-an-offline-upgrade-package"></a>Создание автономного пакета обновления

Чтобы обновить службу приложений в автономной среде, сначала создайте автономный пакет обновления на компьютере, подключенном к Интернету.

1. Запустите файл appservice.exe от имени администратора.

    ![Установщик Службы приложений Azure][1]

2. Последовательно выберите **Дополнительно** > **Create offline package (Создать автономный пакет)** .

    ![Установщик Службы приложений Azure, вкладка "Дополнительно"][2]

3. В установщике Службы приложений Azure будет создан автономный пакет обновления и отобразится путь к нему.  Здесь можно щелкнуть **Открыть папку**, чтобы открыть этот путь в проводнике.

4. Скопируйте установщик (файл AppService.exe) и автономный пакет обновления на компьютер, где работает Azure Stack Hub.

## <a name="complete-the-upgrade-of-app-service-on-azure-stack-hub"></a>Завершение обновления Службы приложений в Azure Stack Hub

> [!IMPORTANT]
> Установщик Службы приложений Azure необходимо запустить на компьютере, у которого есть доступ к конечной точке Azure Resource Manager учетной записи администратора Azure Stack Hub.

1. Запустите файл appservice.exe от имени администратора.

    ![Установщик Службы приложений Azure][1]

2. Последовательно выберите **Дополнительно** > **Complete offline installation or upgrade (Завершить автономную установку или обновление)** .

    ![Установщик Службы приложений Azure, вкладка "Дополнительно"][2]

3. Перейдите к папке с ранее созданным автономным пакетом обновления и нажмите кнопку **Далее**.

4. Просмотрите и примите условия лицензионного соглашения об использовании программного обеспечения Майкрософт, а затем нажмите кнопку **Далее**.

5. Просмотрите и примите условия лицензии сторонних поставщиков и нажмите кнопку **Далее**.

6. Убедитесь, что конечная точка Azure Resource Manager инфраструктуры Azure Stack Hub и сведения о клиенте Active Directory указаны правильно. Если во время развертывания Пакета средств разработки Azure Stack Hub использовались значения по умолчанию, здесь также можно принять эти значения. Но если вы указали другие значения при развертывании Azure Stack Hub, в этом окне необходимо изменить значения соответствующим образом. Например, если используется суффикс домена *mycloud.com*, для конечной точки Azure Resource Manager инфраструктуры Azure Stack Hub нужно указать значение *management.region.mycloud.com*. Проверьте сведения и нажмите кнопку **Далее**.

    ![Сведения об облаке Azure Stack Hub][3]

7. На следующей странице:

   1. Выберите предпочитаемый метод подключения — с помощью **учетных данных** или **субъекта-службы**.
        - **Учетные данные**
            - При использовании Azure Active Directory (Azure AD) введите учетную запись администратора Azure AD и пароль, указанный при развертывании Azure Stack Hub Выберите **Подключиться**.
            - Если вы используете службы федерации Active Directory (AD FS), предоставьте соответствующую учетную запись администратора. Например, cloudadmin@azurestack.local. Введите пароль и затем щелкните **Подключить**.
        - **Субъект-служба**
            - Используемый субъект-служба **должен** иметь права **владельца** в **подписке поставщика по умолчанию**.
            - Укажите значения для параметров **Идентификатор субъект-службы**, **Файл сертификата**, **Пароль** и щелкните **Подключить**.

   1. В разделе **Azure Stack Hub Subscriptions** (Подписки Azure Stack Hub) выберите **Default Provider Subscription** (Подписка поставщика по умолчанию).  Служба приложений Azure в Azure Stack Hub **должна** быть развернута в **подписке поставщика по умолчанию**.

   1. В поле **Azure Stack Hub Locations** (Расположения Azure Stack Hub) выберите расположение, соответствующее региону, в который выполняется развертывание. Например, для развертывания в ASDK выберите **локальное расположение**.
   
   1. Если обнаружено существующее развертывание службы приложений, поля группы ресурсов и учетной записи хранения заполняются и выделяются серым цветом.

      ![Обнаруженная установка Службы приложений Azure][4]
8. На странице "Сводка" выполните следующие действия.
   1. Проверьте выбранные параметры. Чтобы внести изменения, используйте кнопки **Назад** для перехода на предыдущие страницы.
   2. Если настройки указаны правильно, установите флажок.
   3. Чтобы начать обновление, нажмите кнопку **Далее**.

       ![Сводка обновления Службы приложений Azure][5]

9. На странице хода обновления:
    1. Отслеживайте ход обновления. Длительность обновления Службы приложений в Azure Stack Hub зависит от количества развернутых экземпляров ролей.
    2. После успешного обновления щелкните **Выход**.

        ![Ход обновления Службы приложений Azure][6]

<!--Image references-->
[1]: ./media/azure-stack-app-service-update-offline/app-service-exe.png
[2]: ./media/azure-stack-app-service-update-offline/app-service-exe-advanced.png
[3]: ./media/azure-stack-app-service-update-offline/app-service-azure-resource-manager-endpoints.png
[4]: ./media/azure-stack-app-service-update-offline/app-service-installation-detected.png
[5]: ./media/azure-stack-app-service-update-offline/app-service-upgrade-summary.png
[6]: ./media/azure-stack-app-service-update-offline/app-service-upgrade-complete.png

## <a name="next-steps"></a>Дальнейшие действия

Подготовьтесь к операциям администрирования для Службы приложений Azure в Azure Stack Hub

* [Планирование дополнительной емкости](azure-stack-app-service-capacity-planning.md)
* [Добавление дополнительной емкости](azure-stack-app-service-add-worker-roles.md)
