---
title: Часто задаваемые вопросы и сведения о выставлении счетов для Службы приложений Azure в Azure Stack Hub | Документация Майкрософт
description: Узнайте, как измеряется объем потребления и выставляются счета за использование Службы приложений Azure в Azure Stack Hub.
services: azure-stack
documentationcenter: ''
author: apwestgarth
manager: stefsch
editor: ''
ms.assetid: ''
ms.service: azure-stack
ms.workload: app-service
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/10/2019
ms.author: anwestg
ms.reviewer: anwestg
ms.lastreviewed: 06/10/2019
ms.openlocfilehash: 6c409577c73389bb53008ae03cbaf938c61d363f
ms.sourcegitcommit: ce01b2cd114ca8ab5b70c6311b66c58ceb054469
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/13/2020
ms.locfileid: "75924135"
---
# <a name="azure-app-service-on-azure-stack-hub-billing-overview-and-faq"></a>Часто задаваемые вопросы и сведения о выставлении счетов для Службы приложений Azure в Azure Stack Hub

В статье объясняется, как выставляются счета операторам облака за предложение Службы приложений Azure в Azure Stack Hub и как операторы могут выставлять счета арендаторам за использование службы.

## <a name="billing-overview"></a>Общие сведения о выставлении счетов

Операторы Azure Stack Hub соответствующим образом развертывают Службу приложений Azure в Azure Stack Hub, предоставляя своим пользователям возможности арендатора Службы приложений Azure и Функций Azure. Поставщик ресурсов Службы приложений Azure включает роли двух типов: роли инфраструктуры и рабочие роли.

За использование ролей инфраструктуры плата не взимается, так как они требуются для выполнения базовых функций службы. При необходимости роли инфраструктуры можно масштабировать в соответствии с требованиями арендаторов оператора облака. Ниже перечислены роли инфраструктуры.

- Controllers;
- роли управления;
- Издатели
- роли, связанные с внешним интерфейсом.

Есть два типа рабочих ролей: общие и выделенные. Плата за использование рабочих ролей начисляется оператору облака в соответствии с указанными ниже критериями.

## <a name="shared-workers"></a>Общие рабочие роли

Общие рабочие роли — это мультитенантные общие планы Службы приложений без размещения и Функции Azure на основе потребления для многих арендаторов. Плата за использование общих рабочих ролей начинает начисляться, когда они отмечаются как готовые к использованию в поставщике ресурсов Службы приложений Azure.

## <a name="dedicated-workers"></a>Выделенные рабочие роли

Выделенные рабочие роли привязаны к планам Службы приложений, создаваемым арендаторами. Например, в SKU S1 арендаторы могут выполнить масштабирование до 10 экземпляров по умолчанию. Когда арендатор создает план S1, Служба приложений Azure назначает один из экземпляров в небольшом масштабируемом наборе рабочего уровня этому плану Службы приложений арендатора. Выделенная рабочая роль будет недоступной для назначения другим арендаторам. Если арендатор решит масштабировать план Службы приложений до 10 экземпляров, дополнительные 9 рабочих ролей будут изъяты из доступного пула и назначены плану Службы приложений арендатора.

Плата за использование выделенных рабочих ролей начинает начисляться в следующих случаях:

- когда они отмечаются как готовые к использованию в поставщике ресурсов Службы приложений Azure;
- когда они назначаются плану Службы приложений.

Эта модель выставления счетов позволяет операторам облака подготавливать пул выделенных рабочих ролей для клиентов без необходимости платить за рабочие роли, пока они не будут зарезервированы планом Службы приложений арендатора. 

Предположим, что у вас есть 20 рабочих ролей уровня небольшой рабочей роли. Если у вас также есть 5 клиентов, которые создали по 2 плана S1 Службы приложений и которые масштабировали план Службы приложений до 2 экземпляров, у вас не будет доступных рабочих ролей. В результате у вас также не будет емкости ни для существующих, ни для новых клиентов, требуемой для масштабирования или создания новых планов Службы приложений. 

Операторы облака могут просматривать текущее число доступных на рабочем уровне рабочих ролей в конфигурации Службы приложений Azure на портале администрирования Azure Stack Hub.

![Снимок экрана с рабочими ролями Службы приложений][1]

## <a name="see-customer-usage-by-using-the-azure-stack-hub-usage-service"></a>Отслеживание объема использования Службы приложений клиентами с помощью службы контроля использования Azure Stack Hub

Операторы облака могут выполнять запросы к [API использования ресурсов клиента Azure Stack Hub](azure-stack-tenant-resource-usage-api.md), чтобы получить сведения об использовании Службы приложений своими клиентами. Сведения о единицах измерения объема использования, которые формирует Служба приложений для измерения объема использования службы клиентами, см. в статье [Часто задаваемые вопросы об API использования в Azure Stack](azure-stack-usage-related-faq.md). Эти единицы измерения используются для расчета объема использования для каждой отдельной подписки и начисления платы.

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

### <a name="how-do-i-license-the-sql-server-and-file-server-infrastructure-required-in-the-prerequisites"></a>Как лицензировать инфраструктуру SQL Server и файлового сервера, описанную в предварительных требованиях?

Дополнительные сведения о лицензировании инфраструктуры SQL Server и файлового сервера в соответствии с требованиями поставщика ресурсов см. в статье с [предварительными требованиями](azure-stack-app-service-before-you-get-started.md#licensing-concerns-for-required-file-server-and-sql-server).

### <a name="the-usage-faq-lists-the-tenant-meters-but-not-the-prices-for-those-meters-where-can-i-find-them"></a>В статье с вопросами и ответами есть список единиц измерения для арендатора, но нет цен. Где найти сведения о ценах?

Как оператор облака вы можете реализовать собственную модель ценообразования для клиентов. Служба использования предоставляет единицы измерения объема использования. С помощью таких единиц можно начислять плату за использование на основе вашей модели ценообразования. Возможность оператора назначать свои цены обеспечивает конкуренцию между операторами в Azure Stack Hub.

### <a name="as-a-csp-how-can-i-offer-free-and-shared-skus-for-customers-to-try-out-the-service"></a>Будучи поставщиком облачных решений, как я могу предлагать клиентам бесплатные и общие номера SKU для тестирования службы?

Как оператор облака вы несете расходы за предложения бесплатных и общих номеров SKU, так как они размещаются в общих рабочих ролях. Чтобы сократить эти расходы, вы можете уменьшить общий рабочий уровень служб до минимума. 

Например, чтобы предлагать бесплатные и общие номера SKU плана Службы приложений и функции с оплатой по мере использования, вам понадобится как минимум один доступный экземпляр A1. Общие рабочие роли являются мультитенантными, поэтому в них можно размещать несколько клиентских приложений. При этом каждое из них будет изолировано и защищено песочницей Службы приложений. Выполнив такое масштабирование общего рабочего уровня, вы можете ограничить расходы до размера месячной платы за использование одного ядра виртуального ЦП.

Затем вы можете создать квоту для использования с планом, включающим только бесплатные и общие номера SKU и ограничивающим число бесплатных и общих планов Службы приложений, которые могут создавать ваши клиенты.

## <a name="sample-scripts-to-assist-with-billing"></a>Примеры скриптов, упрощающих выставление счетов

Команда Службы приложений Azure разработала примеры скриптов PowerShell, которые помогут вам выполнять запросы к службе контроля использования Azure Stack Hub. С помощью этих примеров скриптов операторы облака могут выставлять счета для своих клиентов. Примеры скриптов доступны в [репозитории средств Azure Stack Hub](https://github.com/Azure/AzureStack-tools) на сайте GitHub. Скрипты находятся в папке [AppService в разделе Usage](https://aka.ms/aa6zku8).

Доступны такие примеры скриптов:

- [Get-AppServiceBillingRecords](https://aka.ms/aa6zku2) получает записи о выставлении счетов в Azure Stack Hub из Службы приложений Azure с помощью API контроля использования Azure Stack Hub.
- [Get-AppServiceSubscriptionUsage](https://aka.ms/aa6zku6) рассчитывает сумму оплаты по подписке за использование Azure Stack Hub. В этом скрипте сумма платы за использование рассчитывается на основе данных от API контроля использования и цен, указанных оператором облака для каждой единицы измерения.
- [Suspend-UserSubscriptions](https://aka.ms/aa6zku7) приостанавливает или возобновляет подписку в зависимости от лимитов использования, заданных оператором облака.

## <a name="next-steps"></a>Дальнейшие действия

- [API использования ресурсов для клиентов](azure-stack-tenant-resource-usage-api.md)

<!--Image references-->
[1]: ./media/app-service-billing-faq/app-service-worker-tiers.png
