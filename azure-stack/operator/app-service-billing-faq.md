---
title: Часто задаваемые вопросы и сведения о выставлении счетов для Службы приложений Azure в Azure Stack | Документация Майкрософт
description: Сведения о том, как начисляется плата за использование Службы приложений Azure в Azure Stack.
services: azure-stack
documentationcenter: ''
author: apwestgarth
manager: stefsch
editor: ''
ms.assetid: ''
ms.service: azure-stack
ms.workload: app-service
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/10/2019
ms.author: anwestg
ms.reviewer: anwestg
ms.lastreviewed: 06/10/2019
ms.openlocfilehash: fa3bc647d11bca915c58aa1bd948881628405776
ms.sourcegitcommit: af63214919e798901399fdffef09650de4176956
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2019
ms.locfileid: "66828373"
---
# <a name="azure-app-service-on-azure-stack-billing-overview-and-faq"></a>Часто задаваемые вопросы и сведения о выставлении счетов для Службы приложений Azure в Azure Stack

*Область применения: интегрированные системы Azure Stack и Пакет средств разработки Azure Stack*

В этом документе показано, как операторам облака начисляется плата за предложения Службы приложений Azure в Azure Stack и как они, в свою очередь, выставляют счета арендаторам за использование службы.

## <a name="billing-overview"></a>Общие сведения о выставлении счетов

Операторы Azure Stack соответствующим образом развертывают Службу приложений Azure в Azure Stack, предоставляя своим пользователям возможности арендатора службы приложений Azure и Функций Azure.  Поставщик ресурсов Службы приложений Azure включает роли двух типов: роли инфраструктуры и рабочие роли.

За использование ролей инфраструктуры плата не взимается, так как они требуются для выполнения базовых функций службы.  При необходимости роли инфраструктуры можно масштабировать в соответствии с требованиями арендаторов оператора облака.  Ниже перечислены роли инфраструктуры.

- Controllers;
- роли управления;
- Издатели
- роли, связанные с внешним интерфейсом.

Есть два типа рабочих ролей: общие и выделенные. Плата за использование рабочих ролей начисляется оператору облака в соответствии с указанными ниже критериями.

## <a name="shared-workers"></a>Общие рабочие роли

Общие рабочие роли — это мультитенантные общие планы Службы приложений без размещения и Функции Azure на основе потребления для многих арендаторов. Плата за использование общих рабочих ролей начинает начисляться, когда они отмечаются как готовые к использованию в поставщике ресурсов Службы приложений Azure.

## <a name="dedicated-workers"></a>Выделенные рабочие роли

Выделенные рабочие роли привязаны к планам Службы приложений, создаваемым арендаторами. Например, в SKU S1 арендаторы могут выполнить масштабирование до 10 экземпляров по умолчанию. Таким образом, когда арендатор создает план S1, Служба приложений Azure назначает один из экземпляров в небольшом масштабируемом наборе рабочего уровня этому арендатора плана Службы приложений. Как следствие, выделенная рабочая роль будет недоступной для назначения другим арендаторам.  Если арендатор решит масштабировать план Службы приложений до 10 экземпляров, дополнительные 9 рабочих ролей будут изъяты из доступного пула и назначены плану Службы приложений арендатора.

Плата за использование рабочих ролей начинает начисляться в следующих случаях:

- когда они отмечаются как готовые к использованию в поставщике ресурсов Службы приложений Azure;
- когда они назначаются плану Службы приложений.

Таким образом, эта модель выставления счетов позволяет операторам облака подготавливать пул выделенных рабочих ролей для клиентов без необходимости платить за рабочие роли, пока они не будут зарезервированы планом Службы приложений арендатора. Например, если у вас есть 20 рабочих ролей уровня небольшой рабочей роли, а также 5 клиентов, которые создали по 2 плана S1 Службы приложений с масштабированием плана Службы приложений до 2 экземпляров, у вас не будет доступных рабочих ролей. В результате у вас также не будет емкости ни для существующих, ни для новых клиентов, требуемой для масштабирования или создания новых планов Службы приложений. Операторы облака могут просматривать текущее число доступных на рабочем уровне рабочих ролей в конфигурации Службы приложений Azure на портале администрирования Azure Stack.

![Рабочие уровни плана Службы приложений][1]

## <a name="see-customer-usage-using-the-azure-stack-usage-service"></a>Просмотр сведений с помощью службы контроля использования Azure Stack

Операторы облака могут запрашивать [API использования арендатора Azure Stack](azure-stack-tenant-resource-usage-api.md), чтобы получать соответствующие сведения для своих клиентов. Информацию по всем индивидуальным счетчикам, которые Служба приложений создает для описания поведения арендатора, можно найти в статье с [часто задаваемыми вопросами об использовании](azure-stack-usage-related-faq.md). С помощью этих счетчиков можно определить показатели использования для подписки клиента, на основе которых затем можно рассчитать плату.

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

### <a name="how-do-i-license-the-sql-server-and-file-server-infrastructure-required-in-the-pre-requisites"></a>Как лицензировать инфраструктуру SQL Server и файлового сервера, описанную в предварительных требованиях?

См. дополнительные сведения о [лицензировании инфраструктуры SQL Server и файлового сервера в соответствии с требованиями поставщика ресурсов Службы приложений Azure в Azure Stack](azure-stack-app-service-before-you-get-started.md#licensing-concerns-for-required-file-server-and-sql-server).

### <a name="the-usage-faq-lists-the-tenant-meters-but-not-the-prices-for-those-meters-where-can-i-find-them"></a>В статье с вопросами и ответами есть список единиц измерения для арендатора, но нет цен. Где найти сведения о ценах?

Операторы облака могут применять собственную ценовую модель для пользователей. Служба контроля использования предоставляет метрики использования. Оператору облака следует использовать полученные единицы измерения для выставления счетов клиентам на основе определенной им ценовой модели. Эта возможность тарификации позволяет операторам выделиться среди других операторов Azure Stack.

### <a name="as-a-csp-how-can-i-offer-free-and-shared-skus-for-customers-to-trial-the-service"></a>Будучи поставщиком облачных решений, как я могу предлагать клиентам бесплатные и общие номера SKU для тестирования службы?

Как оператор облака вы будете нести расходы за предложения бесплатных и общих номеров SKU аналогично тому, как это делается в Azure, так как они размещаются в общих рабочих ролях.  Чтобы сократить эти расходы, вы можете уменьшить общий рабочий уровень до минимума.  Например, чтобы предлагать бесплатные и общие номера SKU плана Службы приложений и функции с оплатой по мере использования, вам понадобится как минимум один доступный экземпляр A1.  Общие рабочие роли являются мультитенантными, поэтому в них можно размещать несколько клиентских приложений, при этом каждое из них будет изолировано и защищено с помощью песочницы Службы приложений.  Выполнив такое масштабирование общего рабочего уровня, вы можете ограничить расходы до размера месячной платы за использование одного ядра виртуального ЦП.

Кроме того, вы можете создать квоту для использования с планом, включающим только бесплатные и общие номера SKU и ограничивающим число бесплатных и общих планов Службы приложений, которые могут создавать ваши клиенты.

## <a name="sample-scripts-to-assist-with-billing"></a>Примеры скриптов, упрощающих выставление счетов

Команда Службы приложений Azure разработала примеры скриптов PowerShell, помогающих с выполнением запросов к службе использования Azure Stack и упрощающих операторам облака задачу выставления своих счетов за свои клиенты.  Примеры скриптов доступны в [репозитории средств Azure Stack](https://github.com/Azure/AzureStack-tools) на GitHub, а скрипты для Службы приложений —в [папке AppService из папки Usage](https://github.com/Azure/AzureStack-Tools/tree/master/Usage/AppService).

Доступны такие примеры скриптов:

- [Get-AppServiceBillingRecords](https://github.com/Azure/AzureStack-Tools/blob/master/Usage/AppService/Get-AppServiceBillingRecords.ps1) получает записи о выставлении счетов в Azure Stack из Службы приложений Azure с помощью API использования Azure Stack.
- [Get-AppServiceSubscriptionUsage](https://github.com/Azure/AzureStack-Tools/blob/master/Usage/AppService/Get-AppServiceSubscriptionUsage.ps1) рассчитывает сумму оплаты по подписке за использование Azure Stack.  В этом скрипте сумма платы за использование рассчитывается на основе данных от API использования и цен, указанных оператором облака для каждой единицы измерения.
- [Suspend-UserSubscriptions](https://github.com/Azure/AzureStack-Tools/blob/master/Usage/AppService/Suspend-UserSubscriptions.ps1) приостанавливает или возобновляет подписку в зависимости от лимитов использования, заданных оператором облака.

## <a name="next-steps"></a>Дополнительная информация

- [API использования арендатора Azure Stack](azure-stack-tenant-resource-usage-api.md)

<!--Image references-->
[1]: ./media/app-service-billing-faq/app-service-worker-tiers.png