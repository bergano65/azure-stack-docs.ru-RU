---
title: Шаблон для реализации решения для обнаружения отсутствия товаров на пограничных устройствах с использованием Azure и Azure Stack Edge.
description: Узнайте, как использовать службы Azure и Azure Stack Edge, чтобы реализовать решение для обнаружения запасов.
author: BryanLa
ms.service: azure-stack
ms.topic: article
ms.date: 11/05/2019
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 11/05/2019
ms.openlocfilehash: fb4eb410eefb8a34bd869543a191a1b044a42f72
ms.sourcegitcommit: 5c92a669007ab4aaffe4484f1d8836a40340dde1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2019
ms.locfileid: "73640097"
---
# <a name="out-of-stock-detection-at-the-edge-pattern"></a>Шаблон обнаружения отсутствия товаров на пограничных устройствах

В этом шаблоне показано, как определить отсутствие товаров на полках с помощью устройства Azure Stack Edge или Azure IoT Edge и сетевых камер.

## <a name="context-and-problem"></a>Контекст и проблема

В традиционных розничных магазинах уровень продаж снижается из-за отсутствия нужного клиентам товара на полке. Тем не менее товар может находиться в отдаленной части магазина, его просто не положили на полку. Магазины хотели бы использовать своих сотрудников более эффективно и автоматически получать уведомления о необходимости пополнения товарных запасов.

## <a name="solution"></a>Решение

В примере решения в каждом магазине используется пограничное устройство, например Azure Stack Edge, которое эффективно обрабатывает данные с камер в магазине. Эта оптимизированная конфигурация позволяет магазинам передавать в облако только соответствующие события и изображения. Конфигурация подразумевает экономию пропускной способности, пространства для хранения и обеспечивает конфиденциальность клиентов. По мере считывания кадров с каждой камеры модель машинного обучения обрабатывает изображение и возвращает все области, нуждающиеся в пополнении товарных запасов. Изображение и области, нуждающиеся в пополнении товарных запасов, отображаются в локальном веб-приложении. Эти данные можно отправить в среду "Аналитика временных рядов", чтобы отобразить аналитические сведения в Power BI.

![архитектура решения для обнаружения отсутствия запасов на пограничном устройстве](media/pattern-out-of-stock-at-edge/solution-architecture.png)

Решение работает следующим образом:
1. Изображения записываются из сетевой камеры по протоколу HTTP или RTSP.
2. Размер изображения изменяется, и изображение отправляется в драйвер вывода, который взаимодействует с моделью машинного обучения, чтобы определить, есть ли изображения с отсутствием товара.
3. Модель машинного обучения выводит все области, нуждающиеся в пополнении товарных запасов.
4. Драйвер вывода передает необработанное изображение в большой двоичный объект (если он указан) и отправляет результаты из модели в Центр Интернета вещей и обработчик ограничивающего прямоугольника на устройстве.
5. Обработчик ограничивающего прямоугольника добавляет ограничивающие прямоугольники на изображение и кэширует путь к изображению в выполняющейся в памяти базе данных.
6. Веб-приложение запрашивает изображения и показывает их в порядке получения.
7. Сообщения из Центра Интернета вещей объединяются в службе "Аналитика временных рядов".
8. В Power BI отображается интерактивный отчет о недостающих товарах за период времени и данные из службы "Аналитика временных рядов".


## <a name="components"></a>Компоненты

Это решение использует следующие компоненты.

| Слой | Компонент | ОПИСАНИЕ |
|----------|-----------|-------------|
| Локальное оборудование | Сетевая камера | Необходимо указать сетевую камеру с каналом HTTP или RTSP, чтобы предоставить изображения для вывода. |
| Azure | Центр Интернета вещей Azure | [Центр Интернета вещей](/azure/iot-hub/) осуществляет подготовку устройств и обмен сообщениями для пограничных устройств. |
|  | Azure Time Series Insights | В [службе "Аналитика временных рядов Azure"](/azure/time-series-insights/) хранятся сообщения из Центра Интернета вещей для визуализации. |
|  | Power BI | [Microsoft Power BI](https://powerbi.microsoft.com/) предоставляет бизнес-отчеты о случаях отсутствия товарных запасов. Power BI предоставляет простой в использовании интерфейс панели мониторинга для просмотра выходных данных Azure Stream Analytics. |
| Устройство Azure Stack Edge или<br>Azure IoT Edge | Azure IoT Edge | [Azure IoT Edge](/azure/iot-edge/) управляет средой выполнения для локальных контейнеров и осуществляет управление устройствами и обновлениями.|
| | Project Brainwave в Azure | На устройстве Azure Stack Edge [Project Brainwave](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) использует программируемые пользователем вентильные матрицы для ускорения вывода Машинного обучения.|

## <a name="issues-and-considerations"></a>Проблемы и рекомендации

Во время выбора варианта реализации этого решения необходимо учитывать приведенные ниже моменты.

### <a name="scalability"></a>Масштабируемость 

Большинство моделей машинного обучения могут работать только с определенным количеством кадров в секунду в зависимости от предоставленного оборудования. Определите оптимальную частоту выборки с камер, чтобы конвейер Машинного обучения не выполнял резервное копирование. Оборудование различных типов будет работать с разным количеством камер и частотой кадров.

### <a name="availability"></a>Доступность

Важно учитывать, что может случиться, если пограничное устройство потеряет подключение. Определите, какие данные могут быть потеряны из службы "Аналитика временных рядов" и панели мониторинга Power BI. Приведенный пример решения не предусматривает высокую доступность.

### <a name="manageability"></a>Управляемость

Это решение может масштабироваться на множество устройств и расположений, что может оказаться неудобным. Службы Интернета вещей Azure могут автоматически переводить новые расположения и устройства в оперативный режим и обновлять их. Необходимо также соблюдать надлежащие процедуры управления данными.

### <a name="security"></a>Безопасность

Этот шаблон подразумевает обработку потенциально конфиденциальных данных. Убедитесь, что ключи регулярно сменяются, а также правильно заданы разрешения для учетной записи хранения Azure и локальных общих папок. 

## <a name="next-steps"></a>Дополнительная информация

Дополнительные сведения по темам, описанным в этой статье:
- В этом шаблоне используются несколько служб, связанных с Интернетом вещей, в том числе [Azure IoT Edge](/azure/iot-edge/), [Центр Интернета вещей](/azure/iot-hub/) и [служба "Аналитика временных рядов Azure"](/azure/time-series-insights/).
- Чтобы узнать больше о Microsoft Project Brainwave, ознакомьтесь с [объявлением блога](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) и просмотрите видео [об ускоренном Машинном обучении Azure с Project Brainwave](https://www.youtube.com/watch?v=DJfMobMjCX0).
- Рекомендации по проектированию гибридных приложений и ответы на дополнительные вопросы см. в [этой статье](overview-app-design-considerations.md).
- См. сведения о [полном семействе продуктов и решений Azure Stack](/azure-stack).

Когда вы будете готовы протестировать пример решения, продолжите работу с руководством по развертыванию [решения распределения данных по уровням для аналитики](https://aka.ms/edgeinferencingdeploy). В этом руководстве содержатся пошаговые инструкции по развертыванию и тестированию компонентов.